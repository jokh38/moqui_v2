<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: mqi::interaction&lt; R, P &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classmqi_1_1interaction.html','','classmqi_1_1interaction-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi::interaction&lt; R, P &gt; Class Template Reference<span class="mlabels"><span class="mlabel abstract">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>A pure virtual class representing the interaction between a particle and a material.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for mqi::interaction&lt; R, P &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1interaction__coll__graph.png" border="0" usemap="#amqi_1_1interaction_3_01_r_00_01_p_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae66185d63971e11abd3ffd5d91d353cc" id="r_ae66185d63971e11abd3ffd5d91d353cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae66185d63971e11abd3ffd5d91d353cc">interaction</a> ()</td></tr>
<tr class="memdesc:ae66185d63971e11abd3ffd5d91d353cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:af00af08286a6a694ecf74db179a69e48" id="r_af00af08286a6a694ecf74db179a69e48"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af00af08286a6a694ecf74db179a69e48">~interaction</a> ()</td></tr>
<tr class="memdesc:af00af08286a6a694ecf74db179a69e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor to ensure proper cleanup in derived classes.  <br /></td></tr>
<tr class="memitem:a98f3828dac7d33b98136496e0f2ba01f" id="r_a98f3828dac7d33b98136496e0f2ba01f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98f3828dac7d33b98136496e0f2ba01f">sample_step_length</a> (const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;rel, const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng)</td></tr>
<tr class="memdesc:a98f3828dac7d33b98136496e0f2ba01f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples a step length based on the interaction's cross-section.  <br /></td></tr>
<tr class="memitem:abd12877853785892a5691a4fab3e1c84" id="r_abd12877853785892a5691a4fab3e1c84"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd12877853785892a5691a4fab3e1c84">sample_step_length</a> (const R cs, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng)</td></tr>
<tr class="memdesc:abd12877853785892a5691a4fab3e1c84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples a step length given a pre-calculated cross-section.  <br /></td></tr>
<tr class="memitem:a6f5d0b9faa506ced6fbcd3d47f5a98c8" id="r_a6f5d0b9faa506ced6fbcd3d47f5a98c8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f5d0b9faa506ced6fbcd3d47f5a98c8">cross_section</a> (const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;rel, const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat)=0</td></tr>
<tr class="memdesc:a6f5d0b9faa506ced6fbcd3d47f5a98c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function to calculate the microscopic cross-section for the interaction.  <br /></td></tr>
<tr class="memitem:ae9ab19fbe9b162cfcc1d4e1831b9d039" id="r_ae9ab19fbe9b162cfcc1d4e1831b9d039"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9ab19fbe9b162cfcc1d4e1831b9d039">along_step</a> (<a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;trk, <a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;stk, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng, const R len, <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat)=0</td></tr>
<tr class="memdesc:ae9ab19fbe9b162cfcc1d4e1831b9d039"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function to apply continuous effects during a particle's step.  <br /></td></tr>
<tr class="memitem:a4e04328fb6ae622c0fc2ddf9b140eea7" id="r_a4e04328fb6ae622c0fc2ddf9b140eea7"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e04328fb6ae622c0fc2ddf9b140eea7">post_step</a> (<a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;trk, <a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;stk, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng, const R len, <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat, bool score_local_deposit)=0</td></tr>
<tr class="memdesc:a4e04328fb6ae622c0fc2ddf9b140eea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function to apply discrete effects at the end of a particle's step.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a4c87b1945089a1884d8052089e552aaf" id="r_a4c87b1945089a1884d8052089e552aaf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c87b1945089a1884d8052089e552aaf">units</a></td></tr>
<tr class="memdesc:a4c87b1945089a1884d8052089e552aaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt; A reference to the singleton object containing physical constants.  <br /></td></tr>
<tr class="memitem:a582d8698f830c8e2acb851b28a9bda6e" id="r_a582d8698f830c8e2acb851b28a9bda6e"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a582d8698f830c8e2acb851b28a9bda6e">T_cut</a> = 0.0815 * units.MeV</td></tr>
<tr class="memdesc:a582d8698f830c8e2acb851b28a9bda6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum step size used for generating dE/dx and cross-section data tables.  <br /></td></tr>
<tr class="memitem:afeb4eec0c348faa44e72fd1ca9808103" id="r_afeb4eec0c348faa44e72fd1ca9808103"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afeb4eec0c348faa44e72fd1ca9808103">max_step</a> = 0.01 * units.cm</td></tr>
<tr class="memitem:af2d98eec57ea0ae65da70863be86588e" id="r_af2d98eec57ea0ae65da70863be86588e"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2d98eec57ea0ae65da70863be86588e">Tp_cut</a> = 0.5 * units.MeV</td></tr>
<tr class="memdesc:af2d98eec57ea0ae65da70863be86588e"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant vector representing the z-axis, used for scattering calculations.  <br /></td></tr>
<tr class="memitem:a99fbaa7e7fc28d4c70c026c6779a445b" id="r_a99fbaa7e7fc28d4c70c026c6779a445b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99fbaa7e7fc28d4c70c026c6779a445b">dir_z</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt;<br />
class mqi::interaction&lt; R, P &gt;</div><p>A pure virtual class representing the interaction between a particle and a material. </p>
<p>In C++, a class containing at least one "pure virtual" function (one marked with <span class="tt">= 0</span>) is an abstract base class. It cannot be instantiated directly. Instead, other classes must inherit from it and provide implementations for all pure virtual functions. This is a fundamental concept in object-oriented programming for creating a common "contract" or interface that different components must adhere to.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">R</td><td>The floating-point type (e.g., <span class="tt">float</span> or <span class="tt">double</span>) for calculations. </td></tr>
    <tr><td class="paramname">P</td><td>The particle type (e.g., <span class="tt">mqi::electron</span>, <span class="tt">mqi::proton</span>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00036">36</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae66185d63971e11abd3ffd5d91d353cc" name="ae66185d63971e11abd3ffd5d91d353cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66185d63971e11abd3ffd5d91d353cc">&#9670;&#160;</a></span>interaction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::interaction </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00059">59</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a id="af00af08286a6a694ecf74db179a69e48" name="af00af08286a6a694ecf74db179a69e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00af08286a6a694ecf74db179a69e48">&#9670;&#160;</a></span>~interaction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::~<a class="el" href="classmqi_1_1interaction.html">interaction</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual destructor to ensure proper cleanup in derived classes. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00065">65</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="ae9ab19fbe9b162cfcc1d4e1831b9d039" name="ae9ab19fbe9b162cfcc1d4e1831b9d039"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ab19fbe9b162cfcc1d4e1831b9d039">&#9670;&#160;</a></span>along_step()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::along_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>trk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>stk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function to apply continuous effects during a particle's step. </p>
<p>This function must be implemented by derived classes. It models processes that occur continuously along the particle's path, such as energy loss due to ionization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">trk</td><td>The particle track to be updated. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stk</td><td>The stack for any newly created secondary particles. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rng</td><td>A pointer to the random number generator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The length of the step. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mat</td><td>The material properties. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classmqi_1_1p__ionization__tabulated.html#a6748a8fea3dd0f180b667eaf483a19f1">mqi::p_ionization_tabulated&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__elastic.html#ad90d2b923a208749f118a8f6410ade2a">mqi::po_elastic&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__inelastic.html#a8624b0db17820083d50ed7bf2b8c3b9f">mqi::po_inelastic&lt; R &gt;</a>, and <a class="el" href="classmqi_1_1pp__elastic.html#af554103e99845928228592e285a3d766">mqi::pp_elastic&lt; R &gt;</a>.</p>

</div>
</div>
<a id="a6f5d0b9faa506ced6fbcd3d47f5a98c8" name="a6f5d0b9faa506ced6fbcd3d47f5a98c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5d0b9faa506ced6fbcd3d47f5a98c8">&#9670;&#160;</a></span>cross_section()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::cross_section </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>rel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function to calculate the microscopic cross-section for the interaction. </p>
<p>This function must be implemented by all derived classes. It calculates the probability of this specific interaction occurring per unit path length. The <span class="tt">= 0</span> syntax makes this a pure virtual function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rel</td><td>Relativistic quantities of the particle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>The material. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The microscopic cross-section in cm^2. </dd></dl>

<p>Implemented in <a class="el" href="classmqi_1_1p__ionization__tabulated.html#a6332a18eb8d1fd678ae0e53fabe56beb">mqi::p_ionization_tabulated&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__elastic.html#ac52a953220e249f7fe99d48fbfcbfc36">mqi::po_elastic&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__elastic__tabulated.html#abfdd1e7f6ef19879d0aeac5399d239b6">mqi::po_elastic_tabulated&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__inelastic.html#a9e2c82ee121e4c1e684f97f23a2f2386">mqi::po_inelastic&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__inelastic__tabulated.html#a1881134bf7c2ae99699b42b401a47078">mqi::po_inelastic_tabulated&lt; R &gt;</a>, <a class="el" href="classmqi_1_1pp__elastic.html#a29f78fb8081407d25d882a0b148936d8">mqi::pp_elastic&lt; R &gt;</a>, and <a class="el" href="classmqi_1_1pp__elastic__tabulated.html#a00c8873253cf6d6d7730a249e8f72190">mqi::pp_elastic_tabulated&lt; R &gt;</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1interaction_a6f5d0b9faa506ced6fbcd3d47f5a98c8_icgraph.png" border="0" usemap="#aclassmqi_1_1interaction_a6f5d0b9faa506ced6fbcd3d47f5a98c8_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a4e04328fb6ae622c0fc2ddf9b140eea7" name="a4e04328fb6ae622c0fc2ddf9b140eea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e04328fb6ae622c0fc2ddf9b140eea7">&#9670;&#160;</a></span>post_step()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::post_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>trk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>stk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>score_local_deposit</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function to apply discrete effects at the end of a particle's step. </p>
<p>This function must be implemented by derived classes. It models discrete events that occur at a single point, such as a scattering event that changes the particle's direction or the creation of a secondary particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">trk</td><td>The particle track to be updated. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stk</td><td>The stack for any newly created secondary particles. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rng</td><td>A pointer to the random number generator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The length of the step. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mat</td><td>The material properties. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">score_local_deposit</td><td>A flag to indicate whether to score energy locally. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classmqi_1_1p__ionization__tabulated.html#a35a90c4d3b472738fb9160a99ad619f8">mqi::p_ionization_tabulated&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__elastic.html#af9e3974c25f180218772d111779286e7">mqi::po_elastic&lt; R &gt;</a>, <a class="el" href="classmqi_1_1po__inelastic__tabulated.html#a20236918908283b478057784ea4a3cfa">mqi::po_inelastic_tabulated&lt; R &gt;</a>, and <a class="el" href="classmqi_1_1pp__elastic__tabulated.html#a0571b59ea2a1d58ea70415239f0e4e74">mqi::pp_elastic_tabulated&lt; R &gt;</a>.</p>

</div>
</div>
<a id="abd12877853785892a5691a4fab3e1c84" name="abd12877853785892a5691a4fab3e1c84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd12877853785892a5691a4fab3e1c84">&#9670;&#160;</a></span>sample_step_length() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::sample_step_length </td>
          <td>(</td>
          <td class="paramtype">const R</td>          <td class="paramname"><span class="paramname"><em>cs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Samples a step length given a pre-calculated cross-section. </p>
<p>This is an overloaded version of <span class="tt">sample_step_length</span> for cases where the total cross-section of multiple processes is already known.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cs</td><td>The total macroscopic cross-section. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rng</td><td>A pointer to the random number generator. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sampled step length in cm. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00101">101</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1interaction_abd12877853785892a5691a4fab3e1c84_cgraph.png" border="0" usemap="#aclassmqi_1_1interaction_abd12877853785892a5691a4fab3e1c84_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a98f3828dac7d33b98136496e0f2ba01f" name="a98f3828dac7d33b98136496e0f2ba01f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98f3828dac7d33b98136496e0f2ba01f">&#9670;&#160;</a></span>sample_step_length() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::sample_step_length </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>rel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Samples a step length based on the interaction's cross-section. </p>
<p>The distance a particle travels before an interaction is probabilistic and can be described by an exponential distribution. This function samples from that distribution using the mean free path (MFP), which is the inverse of the macroscopic cross-section (cs).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rel</td><td>Relativistic quantities of the particle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>The material through which the particle is traveling. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rng</td><td>A pointer to the random number generator. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sampled step length in cm. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00082">82</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1interaction_a98f3828dac7d33b98136496e0f2ba01f_cgraph.png" border="0" usemap="#aclassmqi_1_1interaction_a98f3828dac7d33b98136496e0f2ba01f_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a99fbaa7e7fc28d4c70c026c6779a445b" name="a99fbaa7e7fc28d4c70c026c6779a445b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99fbaa7e7fc28d4c70c026c6779a445b">&#9670;&#160;</a></span>dir_z</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt;R&gt; <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::dir_z</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00054">54</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a id="afeb4eec0c348faa44e72fd1ca9808103" name="afeb4eec0c348faa44e72fd1ca9808103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb4eec0c348faa44e72fd1ca9808103">&#9670;&#160;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::max_step = 0.01 * units.cm</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kinetic energy cutoff for transporting primary particles (protons). If a proton's energy falls below this, it is stopped and its energy is deposited. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00049">49</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a id="a582d8698f830c8e2acb851b28a9bda6e" name="a582d8698f830c8e2acb851b28a9bda6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a582d8698f830c8e2acb851b28a9bda6e">&#9670;&#160;</a></span>T_cut</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::T_cut = 0.0815 * units.MeV</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum step size used for generating dE/dx and cross-section data tables. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00046">46</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a id="af2d98eec57ea0ae65da70863be86588e" name="af2d98eec57ea0ae65da70863be86588e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2d98eec57ea0ae65da70863be86588e">&#9670;&#160;</a></span>Tp_cut</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::Tp_cut = 0.5 * units.MeV</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A constant vector representing the z-axis, used for scattering calculations. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00052">52</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<a id="a4c87b1945089a1884d8052089e552aaf" name="a4c87b1945089a1884d8052089e552aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c87b1945089a1884d8052089e552aaf">&#9670;&#160;</a></span>units</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R, <a class="el" href="namespacemqi.html#a32c063cd869183726bca4551d9e826c8">mqi::particle_t</a> P&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt;R&gt; <a class="el" href="classmqi_1_1interaction.html">mqi::interaction</a>&lt; R, P &gt;::units</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt; A reference to the singleton object containing physical constants. </p>

<p class="definition">Definition at line <a class="el" href="mqi__interaction_8hpp_source.html#l00040">40</a> of file <a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>base/<a class="el" href="mqi__interaction_8hpp_source.html">mqi_interaction.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemqi.html">mqi</a></li><li class="navelem"><a href="classmqi_1_1interaction.html">interaction</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
