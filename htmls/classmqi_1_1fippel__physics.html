<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: mqi::fippel_physics&lt; R &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classmqi_1_1fippel__physics.html','','classmqi_1_1fippel__physics-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi::fippel_physics&lt; R &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A physics list that defines the Fippel model for proton transport.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mqi::fippel_physics&lt; R &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1fippel__physics__inherit__graph.png" border="0" usemap="#amqi_1_1fippel__physics_3_01_r_01_4_inherit__map" loading="lazy" alt="Inheritance graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for mqi::fippel_physics&lt; R &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1fippel__physics__coll__graph.png" border="0" usemap="#amqi_1_1fippel__physics_3_01_r_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae89ba7ac1be170e341543283daf20ba4" id="r_ae89ba7ac1be170e341543283daf20ba4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae89ba7ac1be170e341543283daf20ba4">fippel_physics</a> ()</td></tr>
<tr class="memdesc:ae89ba7ac1be170e341543283daf20ba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:a41b9e0a38d961e86f094bfc8d2b13a5b" id="r_a41b9e0a38d961e86f094bfc8d2b13a5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41b9e0a38d961e86f094bfc8d2b13a5b">fippel_physics</a> (R e_cut)</td></tr>
<tr class="memdesc:a41b9e0a38d961e86f094bfc8d2b13a5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor with a specified energy cutoff for secondary electrons.  <br /></td></tr>
<tr class="memitem:a95bfcb3832f4ab5baab1503ad71c59fc" id="r_a95bfcb3832f4ab5baab1503ad71c59fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95bfcb3832f4ab5baab1503ad71c59fc">~fippel_physics</a> ()</td></tr>
<tr class="memdesc:a95bfcb3832f4ab5baab1503ad71c59fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="memitem:aec06891380034c07deb8bdd0129faa86" id="r_aec06891380034c07deb8bdd0129faa86"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec06891380034c07deb8bdd0129faa86">stepping</a> (<a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;trk, <a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;stk, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng, const R &amp;rho_mass, <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat, const R &amp;distance_to_boundary, bool score_local_deposit)</td></tr>
<tr class="memdesc:aec06891380034c07deb8bdd0129faa86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the step length and samples discrete interactions for a particle track.  <br /></td></tr>
<tr class="inherit_header pub_methods_classmqi_1_1physics__list"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classmqi_1_1physics__list')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Member Functions inherited from <a class="el" href="classmqi_1_1physics__list.html">mqi::physics_list&lt; R &gt;</a></td></tr>
<tr class="memitem:a7c66230baab63b10f9fcc6ad535ee34d inherit pub_methods_classmqi_1_1physics__list" id="r_a7c66230baab63b10f9fcc6ad535ee34d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a7c66230baab63b10f9fcc6ad535ee34d">physics_list</a> ()</td></tr>
<tr class="memdesc:a7c66230baab63b10f9fcc6ad535ee34d inherit pub_methods_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:aab0c332091e2eec359cd9e52f826b44f inherit pub_methods_classmqi_1_1physics__list" id="r_aab0c332091e2eec359cd9e52f826b44f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#aab0c332091e2eec359cd9e52f826b44f">~physics_list</a> ()</td></tr>
<tr class="memdesc:aab0c332091e2eec359cd9e52f826b44f inherit pub_methods_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aa7546bcccbe85ecbaac006e11225d992" id="r_aa7546bcccbe85ecbaac006e11225d992"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt; R &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7546bcccbe85ecbaac006e11225d992">units</a> = <a class="el" href="classmqi_1_1physics__list.html">physics_list</a>&lt;R&gt;::units</td></tr>
<tr class="memdesc:aa7546bcccbe85ecbaac006e11225d992"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt; A reference to the singleton object containing physical constants.  <br /></td></tr>
<tr class="memitem:ac3b46dedbde64ebc358f29a61182a3bb" id="r_ac3b46dedbde64ebc358f29a61182a3bb"><td class="memItemLeft" align="right" valign="top">const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3b46dedbde64ebc358f29a61182a3bb">max_step</a> = 1.0</td></tr>
<tr class="memitem:a2b5002133124add473cc8e4ae9ca40fe" id="r_a2b5002133124add473cc8e4ae9ca40fe"><td class="memItemLeft" align="right" valign="top">const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b5002133124add473cc8e4ae9ca40fe">max_energy_loss</a> = 0.25</td></tr>
<tr class="memdesc:a2b5002133124add473cc8e4ae9ca40fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics model for proton ionization (continuous energy loss).  <br /></td></tr>
<tr class="memitem:ac6cce4c6ee251216d3a80d64eeca809c" id="r_ac6cce4c6ee251216d3a80d64eeca809c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmqi_1_1p__ionization__tabulated.html">mqi::p_ionization_tabulated</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6cce4c6ee251216d3a80d64eeca809c">p_ion</a></td></tr>
<tr class="memdesc:ac6cce4c6ee251216d3a80d64eeca809c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics model for proton-proton (p-p) elastic scattering.  <br /></td></tr>
<tr class="memitem:afc4fdcd65eaee859a380aae397b55cc0" id="r_afc4fdcd65eaee859a380aae397b55cc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc4fdcd65eaee859a380aae397b55cc0">pp_e</a></td></tr>
<tr class="memdesc:afc4fdcd65eaee859a380aae397b55cc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics model for proton-oxygen (p-o) elastic scattering.  <br /></td></tr>
<tr class="memitem:a966db26051894161cc169c9b70374c6d" id="r_a966db26051894161cc169c9b70374c6d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmqi_1_1po__elastic__tabulated.html">mqi::po_elastic_tabulated</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a966db26051894161cc169c9b70374c6d">po_e</a></td></tr>
<tr class="memdesc:a966db26051894161cc169c9b70374c6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physics model for proton-oxygen (p-o) inelastic scattering.  <br /></td></tr>
<tr class="memitem:ac37681c4b300f5b42ec836715a2bf99c" id="r_ac37681c4b300f5b42ec836715a2bf99c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmqi_1_1po__inelastic__tabulated.html">mqi::po_inelastic_tabulated</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac37681c4b300f5b42ec836715a2bf99c">po_i</a></td></tr>
<tr class="inherit_header pub_attribs_classmqi_1_1physics__list"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_attribs_classmqi_1_1physics__list')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Attributes inherited from <a class="el" href="classmqi_1_1physics__list.html">mqi::physics_list&lt; R &gt;</a></td></tr>
<tr class="memitem:a2d5f55a39cbb0be15ce0dfe336ac401b inherit pub_attribs_classmqi_1_1physics__list" id="r_a2d5f55a39cbb0be15ce0dfe336ac401b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a2d5f55a39cbb0be15ce0dfe336ac401b">units</a></td></tr>
<tr class="memdesc:a2d5f55a39cbb0be15ce0dfe336ac401b inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct holding physical constants and conversion factors.  <br /></td></tr>
<tr class="memitem:a477d0d60d446aeb1721e372605e0084e inherit pub_attribs_classmqi_1_1physics__list" id="r_a477d0d60d446aeb1721e372605e0084e"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a477d0d60d446aeb1721e372605e0084e">Te_cut</a> = 0.08511 * units.MeV</td></tr>
<tr class="memdesc:a477d0d60d446aeb1721e372605e0084e inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kinetic energy cut for secondary electrons.  <br /></td></tr>
<tr class="memitem:a7563ccc62d38dbe5822d374c0dfe0ac9 inherit pub_attribs_classmqi_1_1physics__list" id="r_a7563ccc62d38dbe5822d374c0dfe0ac9"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a7563ccc62d38dbe5822d374c0dfe0ac9">Tp_cut</a> = 0.5 * units.MeV</td></tr>
<tr class="memdesc:a7563ccc62d38dbe5822d374c0dfe0ac9 inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kinetic energy cut for secondary protons.  <br /></td></tr>
<tr class="memitem:a5e4f0f5855ab7f89a8f769a1f7e8efe8 inherit pub_attribs_classmqi_1_1physics__list" id="r_a5e4f0f5855ab7f89a8f769a1f7e8efe8"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a5e4f0f5855ab7f89a8f769a1f7e8efe8">Tp_max</a> = 330.0 * units.MeV</td></tr>
<tr class="memdesc:a5e4f0f5855ab7f89a8f769a1f7e8efe8 inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum proton energy to be handled by the simulation.  <br /></td></tr>
<tr class="memitem:a3397bb26add0269604df501a7104ccf2 inherit pub_attribs_classmqi_1_1physics__list" id="r_a3397bb26add0269604df501a7104ccf2"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a3397bb26add0269604df501a7104ccf2">Tp_up</a> = 2.0 * units.MeV</td></tr>
<tr class="memdesc:a3397bb26add0269604df501a7104ccf2 inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper limit for applying restricted stopping power.  <br /></td></tr>
<tr class="memitem:a80a5136f76e3b684d86db1c6488964a3 inherit pub_attribs_classmqi_1_1physics__list" id="r_a80a5136f76e3b684d86db1c6488964a3"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1physics__list.html#a80a5136f76e3b684d86db1c6488964a3">max_step</a> = 1.0 * units.cm</td></tr>
<tr class="memdesc:a80a5136f76e3b684d86db1c6488964a3 inherit pub_attribs_classmqi_1_1physics__list"><td class="mdescLeft">&#160;</td><td class="mdescRight">The absolute maximum allowed step length.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename R&gt;<br />
class mqi::fippel_physics&lt; R &gt;</div><p>A physics list that defines the Fippel model for proton transport. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">R</td><td>The floating-point type (e.g., <span class="tt">float</span>, <span class="tt">double</span>) used for calculations.</td></tr>
  </table>
  </dd>
</dl>
<p>This class acts as the "brain" for the proton simulation. It orchestrates the different physical processes and manages the particle's journey through the material. It combines continuous energy loss from ionization with discrete, random interactions like elastic and inelastic scattering. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00033">33</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae89ba7ac1be170e341543283daf20ba4" name="ae89ba7ac1be170e341543283daf20ba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae89ba7ac1be170e341543283daf20ba4">&#9670;&#160;</a></span>fippel_physics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::fippel_physics </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>
<p>Initializes the tabulated physics models by providing them with energy ranges and pointers to pre-calculated data tables (e.g., <span class="tt">cs_p_ion_table</span>). </p><dl class="section note"><dt>Note</dt><dd><span class="tt">CUDA_HOST_DEVICE</span> allows this to be called from both CPU and GPU code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00060">60</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="a41b9e0a38d961e86f094bfc8d2b13a5b" name="a41b9e0a38d961e86f094bfc8d2b13a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b9e0a38d961e86f094bfc8d2b13a5b">&#9670;&#160;</a></span>fippel_physics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::fippel_physics </td>
          <td>(</td>
          <td class="paramtype">R</td>          <td class="paramname"><span class="paramname"><em>e_cut</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor with a specified energy cutoff for secondary electrons. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">e_cut</td><td>The energy cutoff for secondary electrons (delta rays). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00077">77</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1fippel__physics_a41b9e0a38d961e86f094bfc8d2b13a5b_cgraph.png" border="0" usemap="#aclassmqi_1_1fippel__physics_a41b9e0a38d961e86f094bfc8d2b13a5b_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a95bfcb3832f4ab5baab1503ad71c59fc" name="a95bfcb3832f4ab5baab1503ad71c59fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95bfcb3832f4ab5baab1503ad71c59fc">&#9670;&#160;</a></span>~fippel_physics()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::~<a class="el" href="classmqi_1_1fippel__physics.html">fippel_physics</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00094">94</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="aec06891380034c07deb8bdd0129faa86" name="aec06891380034c07deb8bdd0129faa86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec06891380034c07deb8bdd0129faa86">&#9670;&#160;</a></span>stepping()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::stepping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>trk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>stk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R &amp;</td>          <td class="paramname"><span class="paramname"><em>rho_mass</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R &amp;</td>          <td class="paramname"><span class="paramname"><em>distance_to_boundary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>score_local_deposit</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines the step length and samples discrete interactions for a particle track. </p>
<p>This method implements the core stepping logic for transporting a proton. It decides how far the proton will travel in the current step and what interactions will occur. The logic is as follows:</p>
<ol type="1">
<li><b>Check Energy:</b> If the proton's energy is below the transport cutoff, deposit all remaining energy and stop the track.</li>
<li><b>Calculate Step Limits:</b> Determine the maximum allowed step size based on both a fixed geometric limit (<span class="tt">max_step</span>) and a limit based on the maximum allowed energy loss (<span class="tt">max_energy_loss</span>).</li>
<li><b>Calculate Cross-Sections:</b> Sum the probabilities (cross-sections) of all possible discrete interactions to get a total interaction probability.</li>
<li><b>Sample Mean Free Path (MFP):</b> Randomly sample the distance the particle will travel before its next discrete interaction. This is the MFP.</li>
<li><b>Determine Final Step Length:</b> The actual step length is the <em>minimum</em> of the MFP, the step limits from step 2, and the distance to the next voxel boundary.</li>
<li><b>Apply Continuous Effects:</b> Update the particle's energy and position based on the continuous energy loss over the final step length.</li>
<li><b>Sample Discrete Interaction:</b> If the step was limited by the MFP (meaning a discrete interaction occurred), randomly select which interaction happens based on their relative probabilities and update the particle's state (e.g., change its direction after a scattering event).</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">trk</td><td>The particle track to be transported. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stk</td><td>The stack for created secondary particles. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rng</td><td>A pointer to the random number generator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rho_mass</td><td>The mass density of the current material. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>The material properties of the current voxel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">distance_to_boundary</td><td>The distance to the next geometric boundary. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">score_local_deposit</td><td>A flag indicating whether to score locally deposited energy. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00131">131</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1fippel__physics_aec06891380034c07deb8bdd0129faa86_cgraph.png" border="0" usemap="#aclassmqi_1_1fippel__physics_aec06891380034c07deb8bdd0129faa86_cgraph" loading="lazy" alt=""/></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1fippel__physics_aec06891380034c07deb8bdd0129faa86_icgraph.png" border="0" usemap="#aclassmqi_1_1fippel__physics_aec06891380034c07deb8bdd0129faa86_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a2b5002133124add473cc8e4ae9ca40fe" name="a2b5002133124add473cc8e4ae9ca40fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b5002133124add473cc8e4ae9ca40fe">&#9670;&#160;</a></span>max_energy_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const float <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::max_energy_loss = 0.25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Physics model for proton ionization (continuous energy loss). </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00043">43</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="ac3b46dedbde64ebc358f29a61182a3bb" name="ac3b46dedbde64ebc358f29a61182a3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3b46dedbde64ebc358f29a61182a3bb">&#9670;&#160;</a></span>max_step</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const float <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::max_step = 1.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The maximum energy a proton can lose in a single step, as a fraction of its current energy. This prevents single steps from being too large in high-density or low-energy regions. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00040">40</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="ac6cce4c6ee251216d3a80d64eeca809c" name="ac6cce4c6ee251216d3a80d64eeca809c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6cce4c6ee251216d3a80d64eeca809c">&#9670;&#160;</a></span>p_ion</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1p__ionization__tabulated.html">mqi::p_ionization_tabulated</a>&lt;R&gt; <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::p_ion</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Physics model for proton-proton (p-p) elastic scattering. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00046">46</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="a966db26051894161cc169c9b70374c6d" name="a966db26051894161cc169c9b70374c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a966db26051894161cc169c9b70374c6d">&#9670;&#160;</a></span>po_e</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1po__elastic__tabulated.html">mqi::po_elastic_tabulated</a>&lt;R&gt; <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::po_e</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Physics model for proton-oxygen (p-o) inelastic scattering. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00050">50</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="ac37681c4b300f5b42ec836715a2bf99c" name="ac37681c4b300f5b42ec836715a2bf99c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac37681c4b300f5b42ec836715a2bf99c">&#9670;&#160;</a></span>po_i</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1po__inelastic__tabulated.html">mqi::po_inelastic_tabulated</a>&lt;R&gt; <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::po_i</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00052">52</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="afc4fdcd65eaee859a380aae397b55cc0" name="afc4fdcd65eaee859a380aae397b55cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4fdcd65eaee859a380aae397b55cc0">&#9670;&#160;</a></span>pp_e</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt;R&gt; <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::pp_e</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Physics model for proton-oxygen (p-o) elastic scattering. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00048">48</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<a id="aa7546bcccbe85ecbaac006e11225d992" name="aa7546bcccbe85ecbaac006e11225d992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7546bcccbe85ecbaac006e11225d992">&#9670;&#160;</a></span>units</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt;R&gt;&amp; <a class="el" href="classmqi_1_1fippel__physics.html">mqi::fippel_physics</a>&lt; R &gt;::units = <a class="el" href="classmqi_1_1physics__list.html">physics_list</a>&lt;R&gt;::units</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt; A reference to the singleton object containing physical constants. </p>
<p>The maximum geometric distance (in mm) a proton can travel in a single step. </p>

<p class="definition">Definition at line <a class="el" href="mqi__fippel__physics_8hpp_source.html#l00037">37</a> of file <a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>base/<a class="el" href="mqi__fippel__physics_8hpp_source.html">mqi_fippel_physics.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemqi.html">mqi</a></li><li class="navelem"><a href="classmqi_1_1fippel__physics.html">fippel_physics</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
