<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: mqi::pp_elastic_tabulated&lt; R &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classmqi_1_1pp__elastic__tabulated.html','','classmqi_1_1pp__elastic__tabulated-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi::pp_elastic_tabulated&lt; R &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Represents p-p elastic interaction using tabulated cross-section data.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mqi::pp_elastic_tabulated&lt; R &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1pp__elastic__tabulated__inherit__graph.png" border="0" usemap="#amqi_1_1pp__elastic__tabulated_3_01_r_01_4_inherit__map" loading="lazy" alt="Inheritance graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for mqi::pp_elastic_tabulated&lt; R &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1pp__elastic__tabulated__coll__graph.png" border="0" usemap="#amqi_1_1pp__elastic__tabulated_3_01_r_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4af79a5ece6eb8f852608d22d34084b2" id="r_a4af79a5ece6eb8f852608d22d34084b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4af79a5ece6eb8f852608d22d34084b2">pp_elastic_tabulated</a> (R m, R M, R s, const R *p)</td></tr>
<tr class="memdesc:a4af79a5ece6eb8f852608d22d34084b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a tabulated p-p elastic interaction object.  <br /></td></tr>
<tr class="memitem:a56443fe7edf4eb288d514c332cd3f485" id="r_a56443fe7edf4eb288d514c332cd3f485"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56443fe7edf4eb288d514c332cd3f485">~pp_elastic_tabulated</a> ()</td></tr>
<tr class="memdesc:a56443fe7edf4eb288d514c332cd3f485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. Nullifies the pointer to the cross-section table.  <br /></td></tr>
<tr class="memitem:a0571b59ea2a1d58ea70415239f0e4e74" id="r_a0571b59ea2a1d58ea70415239f0e4e74"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0571b59ea2a1d58ea70415239f0e4e74">post_step</a> (<a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;trk, <a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;stk, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng, const R len, <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat, bool score_local_deposit)</td></tr>
<tr class="memdesc:a0571b59ea2a1d58ea70415239f0e4e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates the interaction after a transport step.  <br /></td></tr>
<tr class="memitem:a00c8873253cf6d6d7730a249e8f72190" id="r_a00c8873253cf6d6d7730a249e8f72190"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00c8873253cf6d6d7730a249e8f72190">cross_section</a> (const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;rel, const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat)</td></tr>
<tr class="memdesc:a00c8873253cf6d6d7730a249e8f72190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the macroscopic cross-section using linear interpolation on the tabulated data.  <br /></td></tr>
<tr class="inherit_header pub_methods_classmqi_1_1pp__elastic"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classmqi_1_1pp__elastic')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Member Functions inherited from <a class="el" href="classmqi_1_1pp__elastic.html">mqi::pp_elastic&lt; R &gt;</a></td></tr>
<tr class="memitem:af554103e99845928228592e285a3d766 inherit pub_methods_classmqi_1_1pp__elastic" id="r_af554103e99845928228592e285a3d766"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1pp__elastic.html#af554103e99845928228592e285a3d766">along_step</a> (<a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;trk, <a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;stk, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng, const R len, <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat)</td></tr>
<tr class="memdesc:af554103e99845928228592e285a3d766 inherit pub_methods_classmqi_1_1pp__elastic"><td class="mdescLeft">&#160;</td><td class="mdescRight">A virtual function to handle actions during a simulation step.  <br /></td></tr>
<tr class="inherit_header pub_methods_classmqi_1_1interaction"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classmqi_1_1interaction')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Member Functions inherited from <a class="el" href="classmqi_1_1interaction.html">mqi::interaction&lt; R, mqi::PROTON &gt;</a></td></tr>
<tr class="memitem:ae66185d63971e11abd3ffd5d91d353cc inherit pub_methods_classmqi_1_1interaction" id="r_ae66185d63971e11abd3ffd5d91d353cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#ae66185d63971e11abd3ffd5d91d353cc">interaction</a> ()</td></tr>
<tr class="memdesc:ae66185d63971e11abd3ffd5d91d353cc inherit pub_methods_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:af00af08286a6a694ecf74db179a69e48 inherit pub_methods_classmqi_1_1interaction" id="r_af00af08286a6a694ecf74db179a69e48"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#af00af08286a6a694ecf74db179a69e48">~interaction</a> ()</td></tr>
<tr class="memdesc:af00af08286a6a694ecf74db179a69e48 inherit pub_methods_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor to ensure proper cleanup in derived classes.  <br /></td></tr>
<tr class="memitem:a98f3828dac7d33b98136496e0f2ba01f inherit pub_methods_classmqi_1_1interaction" id="r_a98f3828dac7d33b98136496e0f2ba01f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#a98f3828dac7d33b98136496e0f2ba01f">sample_step_length</a> (const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;rel, const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;mat, <a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *rng)</td></tr>
<tr class="memdesc:a98f3828dac7d33b98136496e0f2ba01f inherit pub_methods_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples a step length based on the interaction's cross-section.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af89bddd331d1d9e34a5917c84a33dd3e" id="r_af89bddd331d1d9e34a5917c84a33dd3e"><td class="memItemLeft" align="right" valign="top">const R *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a></td></tr>
<tr class="memdesc:af89bddd331d1d9e34a5917c84a33dd3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the tabulated cross-section data.  <br /></td></tr>
<tr class="memitem:a831902619ea47baf583c70da6c22917b" id="r_a831902619ea47baf583c70da6c22917b"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a831902619ea47baf583c70da6c22917b">Ek_min</a></td></tr>
<tr class="memdesc:a831902619ea47baf583c70da6c22917b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum kinetic energy in the cross-section table.  <br /></td></tr>
<tr class="memitem:a0598810c6727beece5c6c008f2471dce" id="r_a0598810c6727beece5c6c008f2471dce"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0598810c6727beece5c6c008f2471dce">Ek_max</a></td></tr>
<tr class="memdesc:a0598810c6727beece5c6c008f2471dce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum kinetic energy in the cross-section table.  <br /></td></tr>
<tr class="memitem:a6bc73128d1b81ad3f48ab776a037b9e2" id="r_a6bc73128d1b81ad3f48ab776a037b9e2"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6bc73128d1b81ad3f48ab776a037b9e2">dEk</a></td></tr>
<tr class="memdesc:a6bc73128d1b81ad3f48ab776a037b9e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy step size in the cross-section table.  <br /></td></tr>
<tr class="inherit_header pub_attribs_classmqi_1_1interaction"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_attribs_classmqi_1_1interaction')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Attributes inherited from <a class="el" href="classmqi_1_1interaction.html">mqi::interaction&lt; R, mqi::PROTON &gt;</a></td></tr>
<tr class="memitem:a4c87b1945089a1884d8052089e552aaf inherit pub_attribs_classmqi_1_1interaction" id="r_a4c87b1945089a1884d8052089e552aaf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmqi_1_1physics__constants.html">physics_constants</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a></td></tr>
<tr class="memdesc:a4c87b1945089a1884d8052089e552aaf inherit pub_attribs_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt; A reference to the singleton object containing physical constants.  <br /></td></tr>
<tr class="memitem:a582d8698f830c8e2acb851b28a9bda6e inherit pub_attribs_classmqi_1_1interaction" id="r_a582d8698f830c8e2acb851b28a9bda6e"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#a582d8698f830c8e2acb851b28a9bda6e">T_cut</a></td></tr>
<tr class="memdesc:a582d8698f830c8e2acb851b28a9bda6e inherit pub_attribs_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum step size used for generating dE/dx and cross-section data tables.  <br /></td></tr>
<tr class="memitem:afeb4eec0c348faa44e72fd1ca9808103 inherit pub_attribs_classmqi_1_1interaction" id="r_afeb4eec0c348faa44e72fd1ca9808103"><td class="memItemLeft" align="right" valign="top">const R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#afeb4eec0c348faa44e72fd1ca9808103">max_step</a></td></tr>
<tr class="memitem:af2d98eec57ea0ae65da70863be86588e inherit pub_attribs_classmqi_1_1interaction" id="r_af2d98eec57ea0ae65da70863be86588e"><td class="memItemLeft" align="right" valign="top">R&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#af2d98eec57ea0ae65da70863be86588e">Tp_cut</a></td></tr>
<tr class="memdesc:af2d98eec57ea0ae65da70863be86588e inherit pub_attribs_classmqi_1_1interaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant vector representing the z-axis, used for scattering calculations.  <br /></td></tr>
<tr class="memitem:a99fbaa7e7fc28d4c70c026c6779a445b inherit pub_attribs_classmqi_1_1interaction" id="r_a99fbaa7e7fc28d4c70c026c6779a445b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; R &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1interaction.html#a99fbaa7e7fc28d4c70c026c6779a445b">dir_z</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename R&gt;<br />
class mqi::pp_elastic_tabulated&lt; R &gt;</div><p>Represents p-p elastic interaction using tabulated cross-section data. </p>
<p>This class extends <span class="tt"><a class="el" href="classmqi_1_1pp__elastic.html" title="Represents the elastic interaction between two protons.">pp_elastic</a></span> to provide a more accurate cross-section calculation based on interpolated values from a data table. It includes a detailed <span class="tt">post_step</span> model to simulate the kinematics of the elastic collision. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">R</td><td>The floating-point type (e.g., float, double). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00131">131</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4af79a5ece6eb8f852608d22d34084b2" name="a4af79a5ece6eb8f852608d22d34084b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4af79a5ece6eb8f852608d22d34084b2">&#9670;&#160;</a></span>pp_elastic_tabulated()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::pp_elastic_tabulated </td>
          <td>(</td>
          <td class="paramtype">R</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R</td>          <td class="paramname"><span class="paramname"><em>M</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a tabulated p-p elastic interaction object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>The minimum kinetic energy (Ek_min) in the table. </td></tr>
    <tr><td class="paramname">M</td><td>The maximum kinetic energy (Ek_max) in the table. </td></tr>
    <tr><td class="paramname">s</td><td>The energy step (dEk) in the table. </td></tr>
    <tr><td class="paramname">p</td><td>A pointer to the cross-section data table. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00148">148</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<a id="a56443fe7edf4eb288d514c332cd3f485" name="a56443fe7edf4eb288d514c332cd3f485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56443fe7edf4eb288d514c332cd3f485">&#9670;&#160;</a></span>~pp_elastic_tabulated()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::~<a class="el" href="classmqi_1_1pp__elastic__tabulated.html">pp_elastic_tabulated</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. Nullifies the pointer to the cross-section table. </p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00158">158</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a00c8873253cf6d6d7730a249e8f72190" name="a00c8873253cf6d6d7730a249e8f72190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00c8873253cf6d6d7730a249e8f72190">&#9670;&#160;</a></span>cross_section()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> R <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::cross_section </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>rel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the macroscopic cross-section using linear interpolation on the tabulated data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rel</td><td>A struct containing the relativistic quantities of the incident proton. </td></tr>
    <tr><td class="paramname">mat</td><td>A struct containing the properties of the target material. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated macroscopic cross-section in cm^-1. </dd></dl>

<p>Reimplemented from <a class="el" href="classmqi_1_1pp__elastic.html#a29f78fb8081407d25d882a0b148936d8">mqi::pp_elastic&lt; R &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00287">287</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1pp__elastic__tabulated_a00c8873253cf6d6d7730a249e8f72190_cgraph.png" border="0" usemap="#aclassmqi_1_1pp__elastic__tabulated_a00c8873253cf6d6d7730a249e8f72190_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a0571b59ea2a1d58ea70415239f0e4e74" name="a0571b59ea2a1d58ea70415239f0e4e74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0571b59ea2a1d58ea70415239f0e4e74">&#9670;&#160;</a></span>post_step()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a> void <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::post_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__t.html">track_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>trk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1track__stack__t.html">track_stack_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>stk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a> *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const R</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmqi_1_1material__t.html">material_t</a>&lt; R &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>score_local_deposit</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Simulates the interaction after a transport step. </p>
<p>This method models the kinematics of a p-p elastic collision. It samples the energy transfer, calculates the scattering angles of both the incident and recoil protons based on relativistic kinematics, updates the primary track's state (energy and direction), and creates a new secondary track for the recoil proton. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trk</td><td>The primary particle track that underwent the interaction. </td></tr>
    <tr><td class="paramname">stk</td><td>The secondary particle stack where the recoil proton is pushed. </td></tr>
    <tr><td class="paramname">rng</td><td>The random number generator for sampling energy transfer. </td></tr>
    <tr><td class="paramname">len</td><td>The step length (not used in this model). </td></tr>
    <tr><td class="paramname">mat</td><td>The material in which the interaction occurred. </td></tr>
    <tr><td class="paramname">score_local_deposit</td><td>Flag indicating whether to score energy locally (not used). </td></tr>
  </table>
  </dd>
</dl>
<p>&lt; energy transfer ratio u = 0 no energy transfer u = 1 100% transfer. this case th1 &amp; th2 may yield nan... u = 0 case, we need to drop primary</p>
<p>&lt; From Lorentz invariant for P-P P1 : incident particle, P2 : target at rest P3 : incident particle, P4 : recoil secondary th3 : (P1 - P3)*(P1 - P3) = (P4 - P2)*(P4 - P2) th4 : (P1 + P2)*(P1 + P2) = (P3 + P4)*(P3 + P4) input energy is vtx1.ke because this is post-step action</p>
<p>&lt; 0&lt;= cos_th3 &lt;= 1</p>
<p>th34 - th3 = th4 (oposite angle against th3)</p>
<p>&lt; phi : angle between scattering plan and reaction plane</p>
<p>&lt; Update Track (P1-&gt;P3)</p>
<p>&lt; Add a new track (P4) P4 is almost same with P3 except KE &amp; DIR</p>

<p>Implements <a class="el" href="classmqi_1_1interaction.html#a4e04328fb6ae622c0fc2ddf9b140eea7">mqi::interaction&lt; R, mqi::PROTON &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00177">177</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1pp__elastic__tabulated_a0571b59ea2a1d58ea70415239f0e4e74_cgraph.png" border="0" usemap="#aclassmqi_1_1pp__elastic__tabulated_a0571b59ea2a1d58ea70415239f0e4e74_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="af89bddd331d1d9e34a5917c84a33dd3e" name="af89bddd331d1d9e34a5917c84a33dd3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af89bddd331d1d9e34a5917c84a33dd3e">&#9670;&#160;</a></span>cs_table</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const R* <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::cs_table</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to the tabulated cross-section data. </p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00134">134</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<a id="a6bc73128d1b81ad3f48ab776a037b9e2" name="a6bc73128d1b81ad3f48ab776a037b9e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bc73128d1b81ad3f48ab776a037b9e2">&#9670;&#160;</a></span>dEk</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::dEk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy step size in the cross-section table. </p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00137">137</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<a id="a0598810c6727beece5c6c008f2471dce" name="a0598810c6727beece5c6c008f2471dce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0598810c6727beece5c6c008f2471dce">&#9670;&#160;</a></span>Ek_max</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::Ek_max</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum kinetic energy in the cross-section table. </p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00136">136</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<a id="a831902619ea47baf583c70da6c22917b" name="a831902619ea47baf583c70da6c22917b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a831902619ea47baf583c70da6c22917b">&#9670;&#160;</a></span>Ek_min</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R <a class="el" href="classmqi_1_1pp__elastic__tabulated.html">mqi::pp_elastic_tabulated</a>&lt; R &gt;::Ek_min</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum kinetic energy in the cross-section table. </p>

<p class="definition">Definition at line <a class="el" href="mqi__pp__elastic_8hpp_source.html#l00135">135</a> of file <a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>base/<a class="el" href="mqi__pp__elastic_8hpp_source.html">mqi_pp_elastic.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemqi.html">mqi</a></li><li class="navelem"><a href="classmqi_1_1pp__elastic__tabulated.html">pp_elastic_tabulated</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
