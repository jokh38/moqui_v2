<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: mqi::treatment_machine_ion&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classmqi_1_1treatment__machine__ion.html','','classmqi_1_1treatment__machine__ion-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi::treatment_machine_ion&lt; T &gt; Class Template Reference<span class="mlabels"><span class="mlabel abstract">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>A class representing a particle therapy system, inheriting from <span class="tt"><a class="el" href="classmqi_1_1treatment__machine.html" title="An abstract base class for all types of radiotherapy treatment machines (RT and ION).">treatment_machine</a></span>.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mqi::treatment_machine_ion&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion__inherit__graph.png" border="0" usemap="#amqi_1_1treatment__machine__ion_3_01_t_01_4_inherit__map" loading="lazy" alt="Inheritance graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for mqi::treatment_machine_ion&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion__coll__graph.png" border="0" usemap="#amqi_1_1treatment__machine__ion_3_01_t_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8c01147601d22431962d081ce7eb052b" id="r_a8c01147601d22431962d081ce7eb052b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c01147601d22431962d081ce7eb052b">treatment_machine_ion</a> ()</td></tr>
<tr class="memdesc:a8c01147601d22431962d081ce7eb052b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:a59dcbc599156b634928bcda58dbfb30c" id="r_a59dcbc599156b634928bcda58dbfb30c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59dcbc599156b634928bcda58dbfb30c">~treatment_machine_ion</a> ()</td></tr>
<tr class="memdesc:a59dcbc599156b634928bcda58dbfb30c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <br /></td></tr>
<tr class="memitem:a2a86a2093fa13b91946be006d0034a4a" id="r_a2a86a2093fa13b91946be006d0034a4a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a86a2093fa13b91946be006d0034a4a">create_coordinate_transform</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m)</td></tr>
<tr class="memdesc:a2a86a2093fa13b91946be006d0034a4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a coordinate transformation from a dataset.  <br /></td></tr>
<tr class="memitem:a8e98be30d93f773066301cb394257491" id="r_a8e98be30d93f773066301cb394257491"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamsource.html">mqi::beamsource</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e98be30d93f773066301cb394257491">create_beamsource</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m, const <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt; pcoord, const float particles_per_history=-1, const float source_to_isocenter_mm=390.0)</td></tr>
<tr class="memdesc:a8e98be30d93f773066301cb394257491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a beam source from a dataset.  <br /></td></tr>
<tr class="memitem:a8dc86b65bd450c4be83e887a469b6fa0" id="r_a8dc86b65bd450c4be83e887a469b6fa0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamsource.html">mqi::beamsource</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8dc86b65bd450c4be83e887a469b6fa0">create_beamsource</a> (const std::vector&lt; <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &gt; &amp;spots, const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m, const <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt; pcoord, const float particles_per_history=-1, const float source_to_isocenter_mm=390.0)</td></tr>
<tr class="memdesc:a8dc86b65bd450c4be83e887a469b6fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a beam source from a vector of spots.  <br /></td></tr>
<tr class="memitem:adaa5a0f11b2880fdaa986e5f4b4e3a40" id="r_adaa5a0f11b2880fdaa986e5f4b4e3a40"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adaa5a0f11b2880fdaa986e5f4b4e3a40">characterize_beamlet</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s)=0</td></tr>
<tr class="memdesc:adaa5a0f11b2880fdaa986e5f4b4e3a40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize a modulated beamlet from DICOM spot information.  <br /></td></tr>
<tr class="memitem:a754584f39051869169facea8b0f773e4" id="r_a754584f39051869169facea8b0f773e4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a754584f39051869169facea8b0f773e4">characterize_beamlet</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s, const float source_to_isocenter_mm)=0</td></tr>
<tr class="memdesc:a754584f39051869169facea8b0f773e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize a modulated beamlet with a specified source-to-isocenter distance.  <br /></td></tr>
<tr class="memitem:a5736db27e1433137cec872ac0280f284" id="r_a5736db27e1433137cec872ac0280f284"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5736db27e1433137cec872ac0280f284">characterize_beamlet</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s0, const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s1)=0</td></tr>
<tr class="memdesc:a5736db27e1433137cec872ac0280f284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize a uniform or modulated-spec beamlet from two spots.  <br /></td></tr>
<tr class="memitem:ab44b2b7035aa07f0d64cc8eb25a60bde" id="r_ab44b2b7035aa07f0d64cc8eb25a60bde"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab44b2b7035aa07f0d64cc8eb25a60bde">characterize_beamlet</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1logspot.html">mqi::beam_module_ion::logspot</a> &amp;s, const float source_to_isocenter_mm, const bool rsuse)=0</td></tr>
<tr class="memdesc:ab44b2b7035aa07f0d64cc8eb25a60bde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize a modulated beamlet from log file spot information.  <br /></td></tr>
<tr class="memitem:afdac8e0f35ab8d4298220fadcd28fb5a" id="r_afdac8e0f35ab8d4298220fadcd28fb5a"><td class="memItemLeft" align="right" valign="top">virtual std::array&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afdac8e0f35ab8d4298220fadcd28fb5a">characterize_beamlet_time</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s_current, const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s_next)</td></tr>
<tr class="memdesc:afdac8e0f35ab8d4298220fadcd28fb5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Characterizes the beam delivery time for a beamlet.  <br /></td></tr>
<tr class="memitem:a7361d53d2abca0658da58f5252f499a2" id="r_a7361d53d2abca0658da58f5252f499a2"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7361d53d2abca0658da58f5252f499a2">characterize_history</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s, float scale)</td></tr>
<tr class="memdesc:a7361d53d2abca0658da58f5252f499a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of histories for a modulated beamlet.  <br /></td></tr>
<tr class="memitem:ae91403b45afb93469715aa096d6e615b" id="r_ae91403b45afb93469715aa096d6e615b"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae91403b45afb93469715aa096d6e615b">characterize_history</a> (const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s0, const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;s1, float scale)</td></tr>
<tr class="memdesc:ae91403b45afb93469715aa096d6e615b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of histories for a uniform or modulated-spec beamlet.  <br /></td></tr>
<tr class="memitem:a4e3d79ed4f124ac55e191c1bf55c02e1" id="r_a4e3d79ed4f124ac55e191c1bf55c02e1"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamline.html">mqi::beamline</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e3d79ed4f124ac55e191c1bf55c02e1">create_beamline</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m)</td></tr>
<tr class="memdesc:a4e3d79ed4f124ac55e191c1bf55c02e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a beamline model from a dataset.  <br /></td></tr>
<tr class="memitem:a0728a87bea5185e47575c243be5d3e6c" id="r_a0728a87bea5185e47575c243be5d3e6c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1rangeshifter.html">mqi::rangeshifter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0728a87bea5185e47575c243be5d3e6c">characterize_rangeshifter</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m)=0</td></tr>
<tr class="memdesc:a0728a87bea5185e47575c243be5d3e6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize a range shifter.  <br /></td></tr>
<tr class="memitem:aa0c448bc0909d1299c857b63164c1e43" id="r_aa0c448bc0909d1299c857b63164c1e43"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1aperture.html">mqi::aperture</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0c448bc0909d1299c857b63164c1e43">characterize_aperture</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m)=0</td></tr>
<tr class="memdesc:aa0c448bc0909d1299c857b63164c1e43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual method to characterize an aperture.  <br /></td></tr>
<tr class="memitem:a82dd2a41c82fb8d4f84c23a1643a2cff" id="r_a82dd2a41c82fb8d4f84c23a1643a2cff"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::vector&lt; std::array&lt; float, 2 &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82dd2a41c82fb8d4f84c23a1643a2cff">characterize_aperture_opening</a> (const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *ds, <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a> m)</td></tr>
<tr class="memdesc:a82dd2a41c82fb8d4f84c23a1643a2cff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Characterizes the aperture opening from a dataset.  <br /></td></tr>
<tr class="memitem:a4dae00a8ad9ac4d592660383ef441cdf" id="r_a4dae00a8ad9ac4d592660383ef441cdf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4dae00a8ad9ac4d592660383ef441cdf">beam_starting_position</a> (const <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; T &gt; &amp;iso, T z)</td></tr>
<tr class="memdesc:a4dae00a8ad9ac4d592660383ef441cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the beam starting position based on the isocenter.  <br /></td></tr>
<tr class="inherit_header pub_methods_classmqi_1_1treatment__machine"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classmqi_1_1treatment__machine')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Public Member Functions inherited from <a class="el" href="classmqi_1_1treatment__machine.html">mqi::treatment_machine&lt; T &gt;</a></td></tr>
<tr class="memitem:a6cfd5eca0c9b8cb494bc472f72228bc7 inherit pub_methods_classmqi_1_1treatment__machine" id="r_a6cfd5eca0c9b8cb494bc472f72228bc7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#a6cfd5eca0c9b8cb494bc472f72228bc7">treatment_machine</a> ()</td></tr>
<tr class="memdesc:a6cfd5eca0c9b8cb494bc472f72228bc7 inherit pub_methods_classmqi_1_1treatment__machine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <br /></td></tr>
<tr class="memitem:a18f3fd4251f8e6fcd068afa52bf5dc2c inherit pub_methods_classmqi_1_1treatment__machine" id="r_a18f3fd4251f8e6fcd068afa52bf5dc2c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#a18f3fd4251f8e6fcd068afa52bf5dc2c">~treatment_machine</a> ()</td></tr>
<tr class="memdesc:a18f3fd4251f8e6fcd068afa52bf5dc2c inherit pub_methods_classmqi_1_1treatment__machine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the abstract base class.  <br /></td></tr>
<tr class="memitem:aa383358d0bc269b470c0d665854b5be8 inherit pub_methods_classmqi_1_1treatment__machine" id="r_aa383358d0bc269b470c0d665854b5be8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmqi_1_1beamsource.html">mqi::beamsource</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#aa383358d0bc269b470c0d665854b5be8">create_beamsource</a> (const <a class="el" href="structmqi_1_1logfiles__t.html">mqi::logfiles_t</a> &amp;logfileData, const <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt; pcoord, const float source_to_isocenter_mm=465.0, const bool rsuse=false)=0</td></tr>
<tr class="memdesc:aa383358d0bc269b470c0d665854b5be8 inherit pub_methods_classmqi_1_1treatment__machine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a beam source model from log file data.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-inherited" class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classmqi_1_1treatment__machine"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_classmqi_1_1treatment__machine')"><span class="dynarrow"><span class="arrowhead closed"></span></span>Protected Attributes inherited from <a class="el" href="classmqi_1_1treatment__machine.html">mqi::treatment_machine&lt; T &gt;</a></td></tr>
<tr class="memitem:a971733414c8de3c30b3b0e7065dd8386 inherit pro_attribs_classmqi_1_1treatment__machine" id="r_a971733414c8de3c30b3b0e7065dd8386"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#a971733414c8de3c30b3b0e7065dd8386">name_</a></td></tr>
<tr class="memdesc:a971733414c8de3c30b3b0e7065dd8386 inherit pro_attribs_classmqi_1_1treatment__machine"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt; Machine name in string format (e.g., "site:system:mc_code").  <br /></td></tr>
<tr class="memitem:adb6c8d07377512e969ecccaa5e78aa8c inherit pro_attribs_classmqi_1_1treatment__machine" id="r_adb6c8d07377512e969ecccaa5e78aa8c"><td class="memItemLeft" align="right" valign="top">std::array&lt; float, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#adb6c8d07377512e969ecccaa5e78aa8c">SAD_</a></td></tr>
<tr class="memdesc:adb6c8d07377512e969ecccaa5e78aa8c inherit pro_attribs_classmqi_1_1treatment__machine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distance from the phase-space plane to the isocenter in mm.  <br /></td></tr>
<tr class="memitem:a2d24c7425642885419697642fc9319ea inherit pro_attribs_classmqi_1_1treatment__machine" id="r_a2d24c7425642885419697642fc9319ea"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmqi_1_1treatment__machine.html#a2d24c7425642885419697642fc9319ea">source_to_isocenter_mm_</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T&gt;<br />
class mqi::treatment_machine_ion&lt; T &gt;</div><p>A class representing a particle therapy system, inheriting from <span class="tt"><a class="el" href="classmqi_1_1treatment__machine.html" title="An abstract base class for all types of radiotherapy treatment machines (RT and ION).">treatment_machine</a></span>. </p>
<p>This class provides a concrete implementation for ion therapy machines, handling the creation of beam sources, beamlines, and coordinate transformations based on DICOM data or other inputs. It includes methods for characterizing beamlets, apertures, and range shifters.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The floating-point type for phase-space variables (e.g., <span class="tt">float</span> or <span class="tt">double</span>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00027">27</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8c01147601d22431962d081ce7eb052b" name="a8c01147601d22431962d081ce7eb052b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c01147601d22431962d081ce7eb052b">&#9670;&#160;</a></span>treatment_machine_ion()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::treatment_machine_ion </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00033">33</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>

</div>
</div>
<a id="a59dcbc599156b634928bcda58dbfb30c" name="a59dcbc599156b634928bcda58dbfb30c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59dcbc599156b634928bcda58dbfb30c">&#9670;&#160;</a></span>~treatment_machine_ion()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::~<a class="el" href="classmqi_1_1treatment__machine__ion.html">treatment_machine_ion</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default destructor. </p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00038">38</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a4dae00a8ad9ac4d592660383ef441cdf" name="a4dae00a8ad9ac4d592660383ef441cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dae00a8ad9ac4d592660383ef441cdf">&#9670;&#160;</a></span>beam_starting_position()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::beam_starting_position </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1vec3.html">mqi::vec3</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>iso</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the beam starting position based on the isocenter. </p>
<p>This method projects the isocenter position back to a given z-plane to determine the beam's starting (x, y) coordinates. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iso</td><td>The isocenter position. </td></tr>
    <tr><td class="paramname">z</td><td>The z-position where the beam starts. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1vec3.html" title="A 3D vector class for position and direction representation.">mqi::vec3</a>&lt;T&gt;</span> representing the beam's starting position. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00349">349</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a4dae00a8ad9ac4d592660383ef441cdf_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a4dae00a8ad9ac4d592660383ef441cdf_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="aa0c448bc0909d1299c857b63164c1e43" name="aa0c448bc0909d1299c857b63164c1e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c448bc0909d1299c857b63164c1e43">&#9670;&#160;</a></span>characterize_aperture()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1aperture.html">mqi::aperture</a> * <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_aperture </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize an aperture. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset for one item of an <span class="tt">IonBeamSequence</span>. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a <span class="tt"><a class="el" href="classmqi_1_1aperture.html" title="Represents a beam-shaping aperture.">mqi::aperture</a></span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Users must implement their own rules to convert DICOM information to aperture specifications. </dd></dl>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#aaf4bdc4b1b2716e032eed1ff04135179">mqi::gtr1&lt; T &gt;</a>, <a class="el" href="classmqi_1_1gtr2.html#ac48dc48c9f4eeb15869a389757e93793">mqi::gtr2&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1pbs.html#abbcdf2001f29d2cc405ad126e6f9b402">mqi::pbs&lt; T &gt;</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_aa0c448bc0909d1299c857b63164c1e43_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_aa0c448bc0909d1299c857b63164c1e43_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a82dd2a41c82fb8d4f84c23a1643a2cff" name="a82dd2a41c82fb8d4f84c23a1643a2cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82dd2a41c82fb8d4f84c23a1643a2cff">&#9670;&#160;</a></span>characterize_aperture_opening()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::vector&lt; std::array&lt; float, 2 &gt; &gt; &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_aperture_opening </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Characterizes the aperture opening from a dataset. </p>
<p>This method extracts the (x, y) coordinates defining the aperture opening(s) from the <span class="tt">BlockSequence</span> in the dataset. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset for one item of an <span class="tt">IonBeamSequence</span>. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of vectors, where each inner vector contains the (x, y) points for a single aperture hole. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Multiple holes are supported. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00318">318</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a82dd2a41c82fb8d4f84c23a1643a2cff_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a82dd2a41c82fb8d4f84c23a1643a2cff_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="ab44b2b7035aa07f0d64cc8eb25a60bde" name="ab44b2b7035aa07f0d64cc8eb25a60bde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab44b2b7035aa07f0d64cc8eb25a60bde">&#9670;&#160;</a></span>characterize_beamlet() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_beamlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1logspot.html">mqi::beam_module_ion::logspot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>source_to_isocenter_mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool</td>          <td class="paramname"><span class="paramname"><em>rsuse</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize a modulated beamlet from log file spot information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>A <span class="tt">logspot</span> object from the log file data. </td></tr>
    <tr><td class="paramname">source_to_isocenter_mm</td><td>The distance from the source to the isocenter in mm. </td></tr>
    <tr><td class="paramname">rsuse</td><td>A boolean indicating whether a range shifter is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamlet.html" title="Represents a single beamlet, capable of generating initial particle states.">mqi::beamlet</a>&lt;T&gt;</span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Connected to <span class="tt"><a class="el" href="mqi__treatment__machine__smc__gtr2_8hpp.html">mqi_treatment_machine_smc_gtr2.hpp</a></span>. Added by Chanil Jeon in 2023. </dd></dl>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#a290f601d39eb1a0a0b989425fd6dbe27">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#aee871631d67114bb4c6ed210661caa52">mqi::gtr1&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1gtr2.html#ab985ca693d6186109c9f73ddd914c94a">mqi::gtr2&lt; T &gt;</a>.</p>

</div>
</div>
<a id="adaa5a0f11b2880fdaa986e5f4b4e3a40" name="adaa5a0f11b2880fdaa986e5f4b4e3a40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa5a0f11b2880fdaa986e5f4b4e3a40">&#9670;&#160;</a></span>characterize_beamlet() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_beamlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize a modulated beamlet from DICOM spot information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>A <span class="tt">spot</span> object from the DICOM data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamlet.html" title="Represents a single beamlet, capable of generating initial particle states.">mqi::beamlet</a>&lt;T&gt;</span> object. </dd></dl>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#a4609526e0f338bb0e4e595ed7a848ab6">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#a18eb27845006d12cba7ff9172e08436b">mqi::gtr1&lt; T &gt;</a>, <a class="el" href="classmqi_1_1gtr2.html#a1c494b7c26c7dcf370b8998331cb967e">mqi::gtr2&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1pbs.html#a757dee449eab476be1a01db3ccac68a6">mqi::pbs&lt; T &gt;</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_adaa5a0f11b2880fdaa986e5f4b4e3a40_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_adaa5a0f11b2880fdaa986e5f4b4e3a40_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a754584f39051869169facea8b0f773e4" name="a754584f39051869169facea8b0f773e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a754584f39051869169facea8b0f773e4">&#9670;&#160;</a></span>characterize_beamlet() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_beamlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>source_to_isocenter_mm</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize a modulated beamlet with a specified source-to-isocenter distance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>A <span class="tt">spot</span> object from the DICOM data. </td></tr>
    <tr><td class="paramname">source_to_isocenter_mm</td><td>The distance from the source to the isocenter in mm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamlet.html" title="Represents a single beamlet, capable of generating initial particle states.">mqi::beamlet</a>&lt;T&gt;</span> object. </dd></dl>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#aff77fd47a661f267d7bfe136517fc279">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#a6e69d6289246fc4e2c37c88d26e41f22">mqi::gtr1&lt; T &gt;</a>, <a class="el" href="classmqi_1_1gtr2.html#a9419b72e7998f7c41dfd39644d8ae3e1">mqi::gtr2&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1pbs.html#a2306b60ab3a81c980cabc3fa92d3b4e3">mqi::pbs&lt; T &gt;</a>.</p>

</div>
</div>
<a id="a5736db27e1433137cec872ac0280f284" name="a5736db27e1433137cec872ac0280f284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5736db27e1433137cec872ac0280f284">&#9670;&#160;</a></span>characterize_beamlet() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamlet.html">mqi::beamlet</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_beamlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s1</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize a uniform or modulated-spec beamlet from two spots. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s0</td><td>The starting spot. </td></tr>
    <tr><td class="paramname">s1</td><td>The ending spot. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamlet.html" title="Represents a single beamlet, capable of generating initial particle states.">mqi::beamlet</a>&lt;T&gt;</span> object. </dd></dl>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#aa4d262d47009731d9fcb11b1741677e2">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#a6299ead20239893b17363ac28f40141e">mqi::gtr1&lt; T &gt;</a>, <a class="el" href="classmqi_1_1gtr2.html#a81e69a82334650929738149cb2fd9f7f">mqi::gtr2&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1pbs.html#a732e5fc73c88124b045aea928db00497">mqi::pbs&lt; T &gt;</a>.</p>

</div>
</div>
<a id="afdac8e0f35ab8d4298220fadcd28fb5a" name="afdac8e0f35ab8d4298220fadcd28fb5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdac8e0f35ab8d4298220fadcd28fb5a">&#9670;&#160;</a></span>characterize_beamlet_time()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::array&lt; T, 2 &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_beamlet_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s_current</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s_next</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Characterizes the beam delivery time for a beamlet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s_current</td><td>The current spot. </td></tr>
    <tr><td class="paramname">s_next</td><td>The next spot in the sequence. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array containing the on-time and off-time in seconds. Defaults to <span class="tt">{1.0, 0.0}</span>. </dd></dl>

<p>Reimplemented in <a class="el" href="classmqi_1_1pbs.html#ad503b6928b54313278e31e690be3f7d5">mqi::pbs&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00235">235</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_afdac8e0f35ab8d4298220fadcd28fb5a_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_afdac8e0f35ab8d4298220fadcd28fb5a_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a7361d53d2abca0658da58f5252f499a2" name="a7361d53d2abca0658da58f5252f499a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7361d53d2abca0658da58f5252f499a2">&#9670;&#160;</a></span>characterize_history() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_history </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>scale</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the number of histories for a modulated beamlet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The spot information from DICOM. </td></tr>
    <tr><td class="paramname">scale</td><td>The scaling factor (particles per history). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of histories to simulate. </dd></dl>

<p>Reimplemented in <a class="el" href="classmqi_1_1pbs.html#a6ea8ea23b8167eacb71e4866cf0e250c">mqi::pbs&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00245">245</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a7361d53d2abca0658da58f5252f499a2_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a7361d53d2abca0658da58f5252f499a2_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="ae91403b45afb93469715aa096d6e615b" name="ae91403b45afb93469715aa096d6e615b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91403b45afb93469715aa096d6e615b">&#9670;&#160;</a></span>characterize_history() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_history </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>scale</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the number of histories for a uniform or modulated-spec beamlet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s0</td><td>The starting spot. </td></tr>
    <tr><td class="paramname">s1</td><td>The ending spot. </td></tr>
    <tr><td class="paramname">scale</td><td>The scaling factor (particles per history). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of histories to simulate. </dd></dl>

<p>Reimplemented in <a class="el" href="classmqi_1_1pbs.html#ae6013723f3aba0711da56f3a2cc1e79c">mqi::pbs&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00255">255</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>

</div>
</div>
<a id="a0728a87bea5185e47575c243be5d3e6c" name="a0728a87bea5185e47575c243be5d3e6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0728a87bea5185e47575c243be5d3e6c">&#9670;&#160;</a></span>characterize_rangeshifter()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1rangeshifter.html">mqi::rangeshifter</a> * <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::characterize_rangeshifter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel pure-virtual">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual method to characterize a range shifter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset for one item of an <span class="tt">IonBeamSequence</span>. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a <span class="tt"><a class="el" href="classmqi_1_1rangeshifter.html" title="Represents a range shifter geometry used in radiotherapy, which can be rectangular or cylindrical.">mqi::rangeshifter</a></span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Users must implement their own rules to convert DICOM information to range shifter specifications. </dd></dl>

<p>Implemented in <a class="el" href="classmqi_1_1gtr1.html#a93d5eb143161679419837ae7741d1122">mqi::gtr1&lt; T &gt;</a>, <a class="el" href="classmqi_1_1gtr2.html#ac96c91132b740b4896e1b8d0e24037ae">mqi::gtr2&lt; T &gt;</a>, and <a class="el" href="classmqi_1_1pbs.html#aa9c9d54975855ff6165721920e69a2f7">mqi::pbs&lt; T &gt;</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a0728a87bea5185e47575c243be5d3e6c_icgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a0728a87bea5185e47575c243be5d3e6c_icgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a4e3d79ed4f124ac55e191c1bf55c02e1" name="a4e3d79ed4f124ac55e191c1bf55c02e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e3d79ed4f124ac55e191c1bf55c02e1">&#9670;&#160;</a></span>create_beamline()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamline.html">mqi::beamline</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::create_beamline </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a beamline model from a dataset. </p>
<p>This method constructs the beamline by identifying and characterizing components like range shifters and apertures from the dataset. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset for one item of an <span class="tt">IonBeamSequence</span>. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type (e.g., <span class="tt">RTIP</span> or <span class="tt">RTIBTR</span>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamline.html" title="Represents a treatment machine beamline.">mqi::beamline</a>&lt;T&gt;</span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This method does not handle coordinate transformations, which are assumed to be managed by the MC engine (e.g., TOPAS). </dd></dl>
<p>&lt; Access to tag LUT</p>
<p>&lt; geometry creation of snout? position from control point 0 <a class="el" href="classmqi_1_1beamline.html#a6103b5380a08772e0f25b98482db46b1" title="Appends a new geometry component to the beamline.">beamline.append_geometry</a>(this-&gt;characterize_snout);</p>
<p>&lt; 1. number of rangeshifter sequence</p>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#a43108b897d9fb4bf0ef2834c4ac9a545">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00270">270</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a4e3d79ed4f124ac55e191c1bf55c02e1_cgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a4e3d79ed4f124ac55e191c1bf55c02e1_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a8e98be30d93f773066301cb394257491" name="a8e98be30d93f773066301cb394257491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e98be30d93f773066301cb394257491">&#9670;&#160;</a></span>create_beamsource() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamsource.html">mqi::beamsource</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::create_beamsource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt;</td>          <td class="paramname"><span class="paramname"><em>pcoord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>particles_per_history</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>source_to_isocenter_mm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">390.0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a beam source from a dataset. </p>
<p>This method constructs a beam source by parsing an <span class="tt">IonBeamSequence</span> from the dataset. It characterizes each spot to create beamlets and determines the number of histories to simulate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset for one item of an <span class="tt">IonBeamSequence</span>. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type (e.g., <span class="tt">RTIP</span> or <span class="tt">RTIBTR</span>). </td></tr>
    <tr><td class="paramname">pcoord</td><td>The coordinate transform to map to the global coordinate system. </td></tr>
    <tr><td class="paramname">particles_per_history</td><td>A scaling factor for the number of particles per history. If -1, each beamlet generates one history. </td></tr>
    <tr><td class="paramname">source_to_isocenter_mm</td><td>The distance from the source to the isocenter in mm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamsource.html" title="Manages a collection of beamlets to model a complete radiation source.">mqi::beamsource</a>&lt;T&gt;</span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Currently, only <span class="tt">MODULATED</span> scan mode is supported. </dd></dl>
<p>&lt; Parse DICOM beam module for Ion</p>
<p>&lt; Modulated BEAM</p>
<p>Calculate number of histories to be simulated per beamlet</p>
<p>Calculate on &amp; off time per beamlet By default, on is set to 1 sec but off is set to 0 sec.</p>
<p>Then, add a beamlet with its number of histories, coordinate system beamlet time on/off</p>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#aff51c1f90c97d57829fa72fe430fe6e1">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00092">92</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a8e98be30d93f773066301cb394257491_cgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a8e98be30d93f773066301cb394257491_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a8dc86b65bd450c4be83e887a469b6fa0" name="a8dc86b65bd450c4be83e887a469b6fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc86b65bd450c4be83e887a469b6fa0">&#9670;&#160;</a></span>create_beamsource() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1beamsource.html">mqi::beamsource</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::create_beamsource </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html">mqi::beam_module_ion::spot</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>spots</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt;</td>          <td class="paramname"><span class="paramname"><em>pcoord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>particles_per_history</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float</td>          <td class="paramname"><span class="paramname"><em>source_to_isocenter_mm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">390.0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a beam source from a vector of spots. </p>
<p>This overload constructs a beam source directly from a list of spot definitions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spots</td><td>A vector of <span class="tt"><a class="el" href="structmqi_1_1beam__module__ion_1_1spot.html" title="A user-defined type representing a single scan spot&#39;s planned parameters.">mqi::beam_module_ion::spot</a></span> objects. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type. </td></tr>
    <tr><td class="paramname">pcoord</td><td>The coordinate transform to map to the global coordinate system. </td></tr>
    <tr><td class="paramname">particles_per_history</td><td>A scaling factor for the number of particles per history. </td></tr>
    <tr><td class="paramname">source_to_isocenter_mm</td><td>The distance from the source to the isocenter in mm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1beamsource.html" title="Manages a collection of beamlets to model a complete radiation source.">mqi::beamsource</a>&lt;T&gt;</span> object. </dd></dl>
<p>&lt; Parse DICOM beam module for ION</p>
<p>&lt; Modulated BEAM</p>
<p>Calculate number of histories to be simulated per beamlet</p>
<p>Calculate on &amp; off time per beamlet By default, on is set to 1 sec but off is set to 0 sec.</p>
<p>Then, add a beamlet with its number of histories, coordinate system beamlet time on/off</p>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#a8a97e89c953a9d309673d259e6e392a1">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00154">154</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmqi_1_1treatment__machine__ion_a8dc86b65bd450c4be83e887a469b6fa0_cgraph.png" border="0" usemap="#aclassmqi_1_1treatment__machine__ion_a8dc86b65bd450c4be83e887a469b6fa0_cgraph" loading="lazy" alt=""/></div>
</div>

</div>
</div>
<a id="a2a86a2093fa13b91946be006d0034a4a" name="a2a86a2093fa13b91946be006d0034a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a86a2093fa13b91946be006d0034a4a">&#9670;&#160;</a></span>create_coordinate_transform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmqi_1_1coordinate__transform.html">mqi::coordinate_transform</a>&lt; T &gt; <a class="el" href="classmqi_1_1treatment__machine__ion.html">mqi::treatment_machine_ion</a>&lt; T &gt;::create_coordinate_transform </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmqi_1_1dataset.html">mqi::dataset</a> *</td>          <td class="paramname"><span class="paramname"><em>ds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemqi.html#a05d2e4147090b4f5c303bb2f0d90e59f">mqi::modality_type</a></td>          <td class="paramname"><span class="paramname"><em>m</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a coordinate transformation from a dataset. </p>
<p>This method extracts gantry, collimator, and couch angles, as well as the isocenter position, from the provided dataset to define the beam's coordinate system. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ds</td><td>Pointer to the dataset containing treatment plan information. </td></tr>
    <tr><td class="paramname">m</td><td>The modality type (e.g., <span class="tt">RTPLAN</span>, <span class="tt">IONPLAN</span>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <span class="tt"><a class="el" href="classmqi_1_1coordinate__transform.html" title="Manages 3D coordinate transformations using a series of rotations and a translation.">mqi::coordinate_transform</a>&lt;T&gt;</span> object. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Rotation angle direction is assumed to be counter-clockwise (CCW). </dd>
<dd>
For RTIBTR, which lacks isocenter data, a position of (0,0,0) is returned. </dd></dl>
<p>&lt; As CW, CRW, NONE, conditionally required, we don't use them at this moment</p>
<p>&lt; Rotation and Position don't exist in RTRECORD and IONRECORD</p>

<p>Implements <a class="el" href="classmqi_1_1treatment__machine.html#a491bbc41d8ab8da147bb5dbb95322c86">mqi::treatment_machine&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html#l00052">52</a> of file <a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>base/<a class="el" href="mqi__treatment__machine__ion_8hpp_source.html">mqi_treatment_machine_ion.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacemqi.html">mqi</a></li><li class="navelem"><a href="classmqi_1_1treatment__machine__ion.html">treatment_machine_ion</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
