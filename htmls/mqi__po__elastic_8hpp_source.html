<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: base/mqi_po_elastic.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('mqi__po__elastic_8hpp_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi_po_elastic.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="mqi__po__elastic_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#ifndef MQI_PO_ELASTIC_HPP</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#define MQI_PO_ELASTIC_HPP</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="mqi__interaction_8hpp.html">moqui/base/mqi_interaction.hpp</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacemqi.html">mqi</a></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>{</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span></div>
<div class="foldopen" id="foldopen00015" data-start="{" data-end="};">
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno"><a class="line" href="namespacemqi.html#ace7aec8e333f369896fe5495ecaebecc">   15</a></span><a class="code hl_define" href="mqi__common_8hpp.html#a43d03f136f9146a99ee64b9fa56f64ce">CUDA_CONSTANT</a> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="namespacemqi.html#ace7aec8e333f369896fe5495ecaebecc">cs_po_e_g4_table</a>[600] = {</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    0.00000, 0.00000, 0.83642, 1.59488, 2.05023, 2.35368, 2.57048, 2.73308, 2.85955, 2.96092,</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    3.04356, 3.11282, 3.17103, 3.22122, 3.26438, 3.30252, 3.33597, 3.36575, 3.39252, 3.41593,</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    3.43935, 3.45608, 3.47616, 3.49289, 3.50627, 3.52300, 3.53303, 3.54642, 3.58991, 3.63006,</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    3.66017, 3.69028, 3.71705, 3.74716, 3.75050, 3.75385, 3.75719, 3.75719, 3.76054, 3.76389,</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    3.75050, 3.73712, 3.72708, 3.71370, 3.70366, 3.69363, 3.68024, 3.67021, 3.66017, 3.65013,</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    3.63675, 3.62337, 3.60998, 3.59660, 3.58656, 3.57318, 3.56314, 3.55311, 3.53972, 3.52969,</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    3.51631, 3.50292, 3.48954, 3.47616, 3.46277, 3.44939, 3.43601, 3.42263, 3.40924, 3.39586,</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    3.37913, 3.36240, 3.34367, 3.32627, 3.30887, 3.29148, 3.27408, 3.25668, 3.23928, 3.22189,</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    3.19579, 3.16969, 3.14360, 3.11750, 3.09140, 3.06531, 3.03921, 3.01312, 2.98702, 2.96092,</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    2.93817, 2.91542, 2.89267, 2.86992, 2.84717, 2.82442, 2.80167, 2.77892, 2.75617, 2.73342,</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    2.71134, 2.68925, 2.66717, 2.64509, 2.62301, 2.60093, 2.57885, 2.55677, 2.53468, 2.51260,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    2.49052, 2.46844, 2.44636, 2.42428, 2.40220, 2.38011, 2.35803, 2.33595, 2.31387, 2.29179,</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    2.27841, 2.26502, 2.25164, 2.23826, 2.22487, 2.21149, 2.19811, 2.18473, 2.17134, 2.15796,</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    2.14458, 2.13120, 2.11781, 2.10443, 2.09105, 2.07766, 2.06428, 2.05090, 2.03752, 2.02413,</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    2.00741, 1.99101, 1.97428, 1.95789, 1.94116, 1.92477, 1.90804, 1.89165, 1.87492, 1.85852,</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    1.84179, 1.82540, 1.80867, 1.79228, 1.77555, 1.75916, 1.74243, 1.72603, 1.70931, 1.69291,</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    1.67786, 1.66280, 1.64775, 1.63269, 1.61763, 1.60258, 1.58752, 1.57247, 1.55741, 1.54236,</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    1.52730, 1.51225, 1.49719, 1.48213, 1.46708, 1.45202, 1.43697, 1.42191, 1.40686, 1.39180,</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    1.38109, 1.37039, 1.35968, 1.34898, 1.33827, 1.32756, 1.31686, 1.30615, 1.29545, 1.28474,</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    1.27403, 1.26333, 1.25262, 1.24191, 1.23121, 1.22050, 1.20980, 1.19909, 1.18838, 1.17768,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    1.16931, 1.16095, 1.15292, 1.14456, 1.13619, 1.12783, 1.11980, 1.11143, 1.10307, 1.09471,</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    1.08668, 1.07831, 1.06995, 1.06158, 1.05355, 1.04519, 1.03682, 1.02846, 1.02043, 1.01207,</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    1.00370, 0.99534, 0.98731, 0.97894, 0.97058, 0.96222, 0.95419, 0.94582, 0.93746, 0.92909,</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    0.92106, 0.91270, 0.90434, 0.89597, 0.88794, 0.87958, 0.87121, 0.86285, 0.85482, 0.84646,</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    0.84010, 0.83408, 0.82772, 0.82170, 0.81534, 0.80932, 0.80296, 0.79694, 0.79058, 0.78456,</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    0.77820, 0.77218, 0.76583, 0.75980, 0.75345, 0.74742, 0.74107, 0.73504, 0.72869, 0.72267,</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    0.71631, 0.71029, 0.70393, 0.69791, 0.69155, 0.68553, 0.67917, 0.67315, 0.66679, 0.66077,</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    0.65441, 0.64839, 0.64204, 0.63601, 0.62966, 0.62363, 0.61728, 0.61125, 0.60490, 0.59888,</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    0.59553, 0.59218, 0.58884, 0.58549, 0.58215, 0.57880, 0.57546, 0.57211, 0.56876, 0.56542,</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    0.56207, 0.55873, 0.55538, 0.55204, 0.54869, 0.54535, 0.54200, 0.53865, 0.53531, 0.53196,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    0.52795, 0.52427, 0.52025, 0.51657, 0.51256, 0.50888, 0.50486, 0.50118, 0.49717, 0.49349,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    0.48947, 0.48579, 0.48178, 0.47810, 0.47408, 0.47040, 0.46639, 0.46271, 0.45869, 0.45501,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    0.45300, 0.45133, 0.44932, 0.44765, 0.44564, 0.44397, 0.44196, 0.44029, 0.43828, 0.43661,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    0.43460, 0.43293, 0.43092, 0.42925, 0.42724, 0.42557, 0.42356, 0.42189, 0.41988, 0.41821,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    0.41620, 0.41453, 0.41252, 0.41085, 0.40884, 0.40717, 0.40516, 0.40349, 0.40148, 0.39981,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    0.39780, 0.39613, 0.39412, 0.39245, 0.39044, 0.38877, 0.38676, 0.38509, 0.38308, 0.38141,</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    0.38040, 0.37940, 0.37840, 0.37739, 0.37639, 0.37538, 0.37438, 0.37338, 0.37237, 0.37137,</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    0.37037, 0.36936, 0.36836, 0.36736, 0.36635, 0.36535, 0.36434, 0.36334, 0.36234, 0.36133,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    0.36033, 0.35933, 0.35832, 0.35732, 0.35631, 0.35531, 0.35431, 0.35330, 0.35230, 0.35130,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    0.35029, 0.34929, 0.34828, 0.34728, 0.34628, 0.34527, 0.34427, 0.34327, 0.34226, 0.34126,</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    0.34092, 0.34059, 0.34026, 0.33992, 0.33959, 0.33925, 0.33892, 0.33858, 0.33825, 0.33791,</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    0.33758, 0.33724, 0.33691, 0.33657, 0.33624, 0.33591, 0.33557, 0.33524, 0.33490, 0.33457,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    0.33423, 0.33390, 0.33356, 0.33323, 0.33289, 0.33256, 0.33223, 0.33189, 0.33156, 0.33122,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    0.33089, 0.33055, 0.33022, 0.32988, 0.32955, 0.32921, 0.32888, 0.32855, 0.32821, 0.32788,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    0.32754, 0.32721, 0.32687, 0.32654, 0.32620, 0.32587, 0.32553, 0.32520, 0.32487, 0.32453,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    0.32420, 0.32386, 0.32353, 0.32319, 0.32286, 0.32252, 0.32219, 0.32185, 0.32152, 0.32118,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    0.32085, 0.32052, 0.32018, 0.31985, 0.31951, 0.31918, 0.31884, 0.31851, 0.31817, 0.31784,</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    0.31750, 0.31717, 0.31684, 0.31650, 0.31617, 0.31583, 0.31550, 0.31516, 0.31483, 0.31449,</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    0.31416, 0.31382, 0.31349, 0.31316, 0.31282, 0.31249, 0.31215, 0.31182, 0.31148, 0.31115,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    0.31081, 0.31048, 0.31014, 0.30981, 0.30947, 0.30914, 0.30881, 0.30847, 0.30814, 0.30780,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    0.30774, 0.30767, 0.30760, 0.30753, 0.30747, 0.30740, 0.30733, 0.30727, 0.30720, 0.30713,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    0.30707, 0.30700, 0.30693, 0.30687, 0.30680, 0.30673, 0.30666, 0.30660, 0.30653, 0.30646,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    0.30640, 0.30633, 0.30626, 0.30620, 0.30613, 0.30606, 0.30600, 0.30593, 0.30586, 0.30579,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    0.30573, 0.30566, 0.30559, 0.30553, 0.30546, 0.30539, 0.30533, 0.30526, 0.30519, 0.30513,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    0.30506, 0.30499, 0.30492, 0.30486, 0.30479, 0.30472, 0.30466, 0.30459, 0.30452, 0.30446,</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    0.30439, 0.30432, 0.30426, 0.30419, 0.30412, 0.30406, 0.30399, 0.30392, 0.30385, 0.30379,</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    0.30372, 0.30365, 0.30359, 0.30352, 0.30345, 0.30339, 0.30332, 0.30325, 0.30319, 0.30312,</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    0.30305, 0.30298, 0.30292, 0.30285, 0.30278, 0.30272, 0.30265, 0.30258, 0.30252, 0.30245,</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    0.30238, 0.30232, 0.30225, 0.30218, 0.30211, 0.30205, 0.30198, 0.30191, 0.30185, 0.30178,</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    0.30171, 0.30165, 0.30158, 0.30151, 0.30145, 0.30138, 0.30131, 0.30124, 0.30118, 0.30111</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>};</div>
</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> R&gt;</div>
<div class="foldopen" id="foldopen00085" data-start="{" data-end="};">
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic.html">   85</a></span><span class="keyword">class </span><a class="code hl_class" href="classmqi_1_1po__elastic.html">po_elastic</a> : <span class="keyword">public</span> <a class="code hl_function" href="classmqi_1_1interaction.html#ae66185d63971e11abd3ffd5d91d353cc">interaction</a>&lt;R, mqi::PROTON&gt;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>{</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="keyword">virtual</span> R</div>
<div class="foldopen" id="foldopen00097" data-start="{" data-end="}">
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic.html#ac52a953220e249f7fe99d48fbfcbfc36">   97</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic.html#ac52a953220e249f7fe99d48fbfcbfc36">cross_section</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities&lt;R&gt;</a>&amp; rel, <span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp; mat) {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        R cs = 0;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <span class="keywordflow">if</span> (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &gt; 50.0 &amp;&amp; rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &lt; 250) {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            cs = 1.88 / rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            cs += 4.0e-5 * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            cs -= 0.01475;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        }</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="comment">//TODO: cs for re.Ek &lt;= 50 ?</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        cs *= mat.<a class="code hl_variable" href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">rho_mass</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        <span class="keywordflow">return</span> cs;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    }</div>
</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00115" data-start="{" data-end="}">
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic.html#ad90d2b923a208749f118a8f6410ade2a">  115</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic.html#ad90d2b923a208749f118a8f6410ade2a">along_step</a>(<a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a>&amp;       trk,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>               <a class="code hl_class" href="classmqi_1_1track__stack__t.html">track_stack_t&lt;R&gt;</a>&amp; stk,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>               <a class="code hl_typedef" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a>*          rng,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>               <span class="keyword">const</span> R           len,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>               <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp;    mat) {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        ;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    }</div>
</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00135" data-start="{" data-end="}">
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic.html#af9e3974c25f180218772d111779286e7">  135</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic.html#af9e3974c25f180218772d111779286e7">post_step</a>(<a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a>&amp;       trk,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>              <a class="code hl_class" href="classmqi_1_1track__stack__t.html">track_stack_t&lt;R&gt;</a>&amp; stk,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>              <a class="code hl_typedef" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a>*          rng,</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>              <span class="keyword">const</span> R           len,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>              <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp;    mat,</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>              <span class="keywordtype">bool</span>              score_local_deposit) {</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">mqi::relativistic_quantities&lt;R&gt;</a> rel(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>, this-&gt;units.Mp);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        <span class="keywordflow">if</span> (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &lt;= 5.5) {</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>            R dE = rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            assert(dE &gt;= 0);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="preprocessor">#ifdef __PHYSICS_DEBUG__</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a> daughter(trk);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a47b0de15eb1624cc562b81caec1457f4">dE</a>       = dE;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a0b8b47567a54aa7cac80fafe42c87ab4">primary</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a069868249224d338446bf27d5aaada96">process</a>  = <a class="code hl_enumvalue" href="namespacemqi.html#a3fd672c3dd5233871d908ca2b7faf8e0acb17d075b3b3e9b5c056e9aaf9e28539">mqi::PO_E</a>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>  = dE;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>  = 0;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>                                  (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                                  (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a75413680b23b9507896be84a32fe276d">status</a>   = <a class="code hl_enumvalue" href="namespacemqi.html#a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e">CREATED</a>;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            stk.<a class="code hl_function" href="classmqi_1_1track__stack__t.html#a54dd3bc633b0c06c1ffa671a2e219d9e">push_secondary</a>(daughter);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a592d3c8cf52cc8615f55ed749f951c19">local_deposit</a>(dE);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a2eb7b29246c1aea2981446380531c1f0">update_post_vertex_energy</a>(dE);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a2fb6ed4e1f15b65001795da2f135b53a">stop</a>();</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>            R Tp_avg = 0.65 * <a class="code hl_function" href="namespacemqi.html#a0c0a3705b73a3f8ca97a1fbb272ff741">mqi::mqi_exp</a>(-0.0013 * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            Tp_avg -= 0.71 * <a class="code hl_function" href="namespacemqi.html#a0c0a3705b73a3f8ca97a1fbb272ff741">mqi::mqi_exp</a>(-0.0177 * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            R Tp_max = (2.0 * this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mo * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#ade51e983ba01f58a06bb3095f439af5b">beta_sq</a> * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#ab5daa585de9d5faab1edaf78bd060d69">gamma_sq</a>);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>            Tp_max /= (1.0 + 2.0 * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#aa91e2c1a2f22c32b21fc632ea118b596">gamma</a> * this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.MoMp + this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.MoMp_sq);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>            R dE = <a class="code hl_function" href="namespacemqi.html#a0afb2cc4c506dc538aa2570a840b8442">mqi::mqi_exponential&lt;R&gt;</a>(rng, 1.0 / Tp_avg, Tp_max);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            assert(dE &gt;= 0 &amp;&amp; dE &lt;= Tp_max);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            R E1      = rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> * (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> + 2.0 * this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            R E3      = (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> - dE) * (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> - dE + 2.0 * this-&gt;units.Mp);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            R cos_th3 = (E1 + E3 - dE * (dE + 2.0 * this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mo)) / 2.0 / <a class="code hl_function" href="namespacemqi.html#aef88923de451fcfef0ae37638919075f">mqi::mqi_sqrt</a>(E1 * E3);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            <span class="keywordflow">if</span> (cos_th3 &gt; 1.0) cos_th3 = 1.0;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            <span class="keywordflow">if</span> (cos_th3 &lt; -1.0) cos_th3 = -1.0;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            R th3 = <a class="code hl_function" href="namespacemqi.html#a91a6ed407b1f63e7150657ef1aef1194">mqi::mqi_acos&lt;R&gt;</a>(cos_th3);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>            R phi = 2.0 * M_PI * <a class="code hl_function" href="namespacemqi.html#add466ef65529d5cbcb7b8a1ee9b32778">mqi::mqi_uniform&lt;R&gt;</a>(rng);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            assert(dE &gt;= 0);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="preprocessor">#ifdef __PHYSICS_DEBUG__</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            <a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a> daughter(trk);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a47b0de15eb1624cc562b81caec1457f4">dE</a>       = dE;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a0b8b47567a54aa7cac80fafe42c87ab4">primary</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a069868249224d338446bf27d5aaada96">process</a>  = <a class="code hl_enumvalue" href="namespacemqi.html#a3fd672c3dd5233871d908ca2b7faf8e0acb17d075b3b3e9b5c056e9aaf9e28539">mqi::PO_E</a>;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>  = dE;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>  = 0;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a75413680b23b9507896be84a32fe276d">status</a>   = <a class="code hl_enumvalue" href="namespacemqi.html#a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e">CREATED</a>;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                                  (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                                  (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            stk.<a class="code hl_function" href="classmqi_1_1track__stack__t.html#a54dd3bc633b0c06c1ffa671a2e219d9e">push_secondary</a>(daughter);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a592d3c8cf52cc8615f55ed749f951c19">local_deposit</a>(dE);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a2eb7b29246c1aea2981446380531c1f0">update_post_vertex_energy</a>(dE);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            trk.<a class="code hl_function" href="classmqi_1_1track__t.html#ac0ddd58c6eb270f43d091cf853ca355c">update_post_vertex_direction</a>(th3, phi);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="preprocessor">#if !defined(__CUDACC__)</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            <span class="keywordflow">if</span> (std::isnan(th3) || std::isnan(phi))</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                printf(<span class="stringliteral">&quot;po_e E1 %f E3 %f rel.Ek %f cos_th3 %f th3 %f phi %f\n&quot;</span>,</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                       E1,</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                       E3,</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                       rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>,</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                       cos_th3,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                       th3,</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                       phi);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            <span class="keywordflow">if</span> (std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) || std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) ||</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>)) {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                printf(<span class="stringliteral">&quot;inside po_e\n&quot;</span>);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                printf(<span class="stringliteral">&quot;th3 %f phi %f\n&quot;</span>, th3, phi);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                printf(<span class="stringliteral">&quot;po_e ke: %f\n&quot;</span>, trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                printf(<span class="stringliteral">&quot;1 &quot;</span>);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>                printf(<span class="stringliteral">&quot;2 &quot;</span>);</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                printf(<span class="stringliteral">&quot;3 &quot;</span>);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                printf(<span class="stringliteral">&quot;4 &quot;</span>);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            }</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            assert(!std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) &amp;&amp; !std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) &amp;&amp;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                   !std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>));</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            assert(!std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) &amp;&amp; !std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) &amp;&amp;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>                   !std::isnan(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>));</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    }</div>
</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>};</div>
</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> R&gt;</div>
<div class="foldopen" id="foldopen00258" data-start="{" data-end="};">
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html">  258</a></span><span class="keyword">class </span><a class="code hl_function" href="classmqi_1_1po__elastic__tabulated.html#a0a05a17cdbf7843b83b00750e0f2ec4b">po_elastic_tabulated</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmqi_1_1po__elastic.html">po_elastic</a>&lt;R&gt;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>{</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">  261</a></span>    <span class="keyword">const</span> R* <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">cs_table</a>;   </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">  262</a></span>    R        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">Ek_min</a> = 0.5;     </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#aad9d3ce6dc312c9c704547ec4b7102cd">  263</a></span>    R        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#aad9d3ce6dc312c9c704547ec4b7102cd">Ek_max</a> = 300.0;   </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">  264</a></span>    R        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">dEk</a>    = 0.5;     </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="foldopen" id="foldopen00275" data-start="{" data-end="}">
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#a0a05a17cdbf7843b83b00750e0f2ec4b">  275</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic__tabulated.html#a0a05a17cdbf7843b83b00750e0f2ec4b">po_elastic_tabulated</a>(R m, R M, R s, <span class="keyword">const</span> R* p) : <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">cs_table</a>(p) {</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">Ek_min</a> = m;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#aad9d3ce6dc312c9c704547ec4b7102cd">Ek_max</a> = M;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">dEk</a>    = s;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    }</div>
</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="foldopen" id="foldopen00285" data-start="{" data-end="}">
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#a91e765c19be550343e32e9fa496dfcb6">  285</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic__tabulated.html#a91e765c19be550343e32e9fa496dfcb6">~po_elastic_tabulated</a>() {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">cs_table</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keyword">virtual</span> R</div>
<div class="foldopen" id="foldopen00297" data-start="{" data-end="}">
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno"><a class="line" href="classmqi_1_1po__elastic__tabulated.html#abfdd1e7f6ef19879d0aeac5399d239b6">  297</a></span>    <a class="code hl_function" href="classmqi_1_1po__elastic__tabulated.html#abfdd1e7f6ef19879d0aeac5399d239b6">cross_section</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities&lt;R&gt;</a>&amp; rel, <span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp; mat) {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        R cs = 0;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <span class="keywordflow">if</span> (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &gt;= <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">Ek_min</a> &amp;&amp; rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &lt;= <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#aad9d3ce6dc312c9c704547ec4b7102cd">Ek_max</a>) {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            uint16_t idx0 = uint16_t((rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> - <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">Ek_min</a>) / <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">dEk</a>);   <span class="comment">//0 - 598</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            uint16_t idx1 = idx0 + 1;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            R        x0   = <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">Ek_min</a> + idx0 * <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">dEk</a>;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>            R        x1   = x0 + 0.5;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>            cs            = <a class="code hl_function" href="namespacemqi.html#a3056e4aa71c04575840237dbfe35b397">mqi::intpl1d&lt;R&gt;</a>(rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>, x0, x1, <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">cs_table</a>[idx0], <a class="code hl_variable" href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">cs_table</a>[idx1]);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        cs *= mat.<a class="code hl_variable" href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">rho_mass</a>;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keywordflow">return</span> cs;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    }</div>
</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>};</div>
</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>}   <span class="comment">// namespace mqi</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassmqi_1_1interaction_html_a4c87b1945089a1884d8052089e552aaf"><div class="ttname"><a href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">mqi::interaction&lt; R, mqi::PROTON &gt;::units</a></div><div class="ttdeci">const physics_constants&lt; R &gt; units</div><div class="ttdef"><b>Definition</b> <a href="mqi__interaction_8hpp_source.html#l00040">mqi_interaction.hpp:40</a></div></div>
<div class="ttc" id="aclassmqi_1_1interaction_html_ae66185d63971e11abd3ffd5d91d353cc"><div class="ttname"><a href="classmqi_1_1interaction.html#ae66185d63971e11abd3ffd5d91d353cc">mqi::interaction&lt; R, mqi::PROTON &gt;::interaction</a></div><div class="ttdeci">CUDA_HOST_DEVICE interaction()</div><div class="ttdef"><b>Definition</b> <a href="mqi__interaction_8hpp_source.html#l00059">mqi_interaction.hpp:59</a></div></div>
<div class="ttc" id="aclassmqi_1_1material__t_html"><div class="ttname"><a href="classmqi_1_1material__t.html">mqi::material_t</a></div><div class="ttdoc">water_t</div><div class="ttdef"><b>Definition</b> <a href="materials_2mqi__material_8hpp_source.html#l00044">mqi_material.hpp:45</a></div></div>
<div class="ttc" id="aclassmqi_1_1material__t_html_aab85e9eede73428b945e31b13e2e571e"><div class="ttname"><a href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">mqi::material_t::rho_mass</a></div><div class="ttdeci">R rho_mass</div><div class="ttdoc">Electron density in electrons/mm^3.</div><div class="ttdef"><b>Definition</b> <a href="materials_2mqi__material_8hpp_source.html#l00053">mqi_material.hpp:53</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_a0a05a17cdbf7843b83b00750e0f2ec4b"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#a0a05a17cdbf7843b83b00750e0f2ec4b">mqi::po_elastic_tabulated::po_elastic_tabulated</a></div><div class="ttdeci">CUDA_HOST_DEVICE po_elastic_tabulated(R m, R M, R s, const R *p)</div><div class="ttdoc">Constructs a new po_elastic_tabulated object.</div><div class="ttdef"><b>Definition</b> <a href="#l00275">mqi_po_elastic.hpp:275</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_a91e765c19be550343e32e9fa496dfcb6"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#a91e765c19be550343e32e9fa496dfcb6">mqi::po_elastic_tabulated::~po_elastic_tabulated</a></div><div class="ttdeci">CUDA_HOST_DEVICE ~po_elastic_tabulated()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition</b> <a href="#l00285">mqi_po_elastic.hpp:285</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_aad9d3ce6dc312c9c704547ec4b7102cd"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#aad9d3ce6dc312c9c704547ec4b7102cd">mqi::po_elastic_tabulated::Ek_max</a></div><div class="ttdeci">R Ek_max</div><div class="ttdoc">The maximum energy of the table.</div><div class="ttdef"><b>Definition</b> <a href="#l00263">mqi_po_elastic.hpp:263</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_abb6e79d27013b0cf09f16199c281bff0"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#abb6e79d27013b0cf09f16199c281bff0">mqi::po_elastic_tabulated::dEk</a></div><div class="ttdeci">R dEk</div><div class="ttdoc">The energy step size of the table.</div><div class="ttdef"><b>Definition</b> <a href="#l00264">mqi_po_elastic.hpp:264</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_abd664fb28e505ab5ac2cfa8ee199492e"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#abd664fb28e505ab5ac2cfa8ee199492e">mqi::po_elastic_tabulated::Ek_min</a></div><div class="ttdeci">R Ek_min</div><div class="ttdoc">The minimum energy of the table.</div><div class="ttdef"><b>Definition</b> <a href="#l00262">mqi_po_elastic.hpp:262</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_abfdd1e7f6ef19879d0aeac5399d239b6"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#abfdd1e7f6ef19879d0aeac5399d239b6">mqi::po_elastic_tabulated::cross_section</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE R cross_section(const relativistic_quantities&lt; R &gt; &amp;rel, const material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">Calculates the cross-section for p-O elastic scattering using table interpolation.</div><div class="ttdef"><b>Definition</b> <a href="#l00297">mqi_po_elastic.hpp:297</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic__tabulated_html_afcd65846e39daaaf72add46b1a2aa380"><div class="ttname"><a href="classmqi_1_1po__elastic__tabulated.html#afcd65846e39daaaf72add46b1a2aa380">mqi::po_elastic_tabulated::cs_table</a></div><div class="ttdeci">const R * cs_table</div><div class="ttdoc">Pointer to the cross-section table.</div><div class="ttdef"><b>Definition</b> <a href="#l00261">mqi_po_elastic.hpp:261</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic_html"><div class="ttname"><a href="classmqi_1_1po__elastic.html">mqi::po_elastic</a></div><div class="ttdoc">An analytical model for proton-oxygen elastic scattering.</div><div class="ttdef"><b>Definition</b> <a href="#l00085">mqi_po_elastic.hpp:86</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic_html_ac52a953220e249f7fe99d48fbfcbfc36"><div class="ttname"><a href="classmqi_1_1po__elastic.html#ac52a953220e249f7fe99d48fbfcbfc36">mqi::po_elastic::cross_section</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE R cross_section(const relativistic_quantities&lt; R &gt; &amp;rel, const material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">Calculates the cross-section for p-O elastic scattering.</div><div class="ttdef"><b>Definition</b> <a href="#l00097">mqi_po_elastic.hpp:97</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic_html_ad90d2b923a208749f118a8f6410ade2a"><div class="ttname"><a href="classmqi_1_1po__elastic.html#ad90d2b923a208749f118a8f6410ade2a">mqi::po_elastic::along_step</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE void along_step(track_t&lt; R &gt; &amp;trk, track_stack_t&lt; R &gt; &amp;stk, mqi_rng *rng, const R len, material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">A placeholder for along-step actions. This interaction is purely discrete.</div><div class="ttdef"><b>Definition</b> <a href="#l00115">mqi_po_elastic.hpp:115</a></div></div>
<div class="ttc" id="aclassmqi_1_1po__elastic_html_af9e3974c25f180218772d111779286e7"><div class="ttname"><a href="classmqi_1_1po__elastic.html#af9e3974c25f180218772d111779286e7">mqi::po_elastic::post_step</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE void post_step(track_t&lt; R &gt; &amp;trk, track_stack_t&lt; R &gt; &amp;stk, mqi_rng *rng, const R len, material_t&lt; R &gt; &amp;mat, bool score_local_deposit)</div><div class="ttdoc">Simulates the p-O elastic scattering event.</div><div class="ttdef"><b>Definition</b> <a href="#l00135">mqi_po_elastic.hpp:135</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html">mqi::relativistic_quantities</a></div><div class="ttdoc">A struct to calculate and store essential relativistic quantities for a particle.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00028">mqi_relativistic_quantities.hpp:29</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_a0680900ad1acc19d12c7ec912d250649"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">mqi::relativistic_quantities::Ek</a></div><div class="ttdeci">R Ek</div><div class="ttdoc">The kinetic energy of the particle in MeV.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00036">mqi_relativistic_quantities.hpp:36</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_aa91e2c1a2f22c32b21fc632ea118b596"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#aa91e2c1a2f22c32b21fc632ea118b596">mqi::relativistic_quantities::gamma</a></div><div class="ttdeci">R gamma</div><div class="ttdoc">The Lorentz factor, gamma = 1 / sqrt(1 - beta^2). It quantifies the time dilation and length contract...</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00033">mqi_relativistic_quantities.hpp:33</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_ab5daa585de9d5faab1edaf78bd060d69"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#ab5daa585de9d5faab1edaf78bd060d69">mqi::relativistic_quantities::gamma_sq</a></div><div class="ttdeci">R gamma_sq</div><div class="ttdoc">The square of the Lorentz factor.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00032">mqi_relativistic_quantities.hpp:32</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_ade51e983ba01f58a06bb3095f439af5b"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#ade51e983ba01f58a06bb3095f439af5b">mqi::relativistic_quantities::beta_sq</a></div><div class="ttdeci">R beta_sq</div><div class="ttdoc">The square of the particle&#39;s velocity relative to the speed of light (v^2/c^2). Beta is the speed of ...</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00031">mqi_relativistic_quantities.hpp:31</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__stack__t_html"><div class="ttname"><a href="classmqi_1_1track__stack__t.html">mqi::track_stack_t</a></div><div class="ttdoc">A simple, fixed-size stack for managing secondary particle tracks.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track__stack_8hpp_source.html#l00036">mqi_track_stack.hpp:37</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__stack__t_html_a54dd3bc633b0c06c1ffa671a2e219d9e"><div class="ttname"><a href="classmqi_1_1track__stack__t.html#a54dd3bc633b0c06c1ffa671a2e219d9e">mqi::track_stack_t::push_secondary</a></div><div class="ttdeci">CUDA_HOST_DEVICE void push_secondary(const track_t&lt; R &gt; &amp;trk)</div><div class="ttdoc">Pushes a secondary track onto the top of the stack.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track__stack_8hpp_source.html#l00077">mqi_track_stack.hpp:77</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html"><div class="ttname"><a href="classmqi_1_1track__t.html">mqi::track_t</a></div><div class="ttdoc">Represents a particle&#39;s state and its path through the simulation.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00069">mqi_track.hpp:70</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a069868249224d338446bf27d5aaada96"><div class="ttname"><a href="classmqi_1_1track__t.html#a069868249224d338446bf27d5aaada96">mqi::track_t::process</a></div><div class="ttdeci">process_t process</div><div class="ttdoc">The physics or geometry process that limited the last step.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00074">mqi_track.hpp:74</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a0b8b47567a54aa7cac80fafe42c87ab4"><div class="ttname"><a href="classmqi_1_1track__t.html#a0b8b47567a54aa7cac80fafe42c87ab4">mqi::track_t::primary</a></div><div class="ttdeci">bool primary</div><div class="ttdoc">Flag indicating if this is a primary particle (true) or a secondary (false).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00075">mqi_track.hpp:75</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a2eb7b29246c1aea2981446380531c1f0"><div class="ttname"><a href="classmqi_1_1track__t.html#a2eb7b29246c1aea2981446380531c1f0">mqi::track_t::update_post_vertex_energy</a></div><div class="ttdeci">CUDA_HOST_DEVICE void update_post_vertex_energy(const R &amp;e)</div><div class="ttdoc">Updates the post-step kinetic energy after an energy loss event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00244">mqi_track.hpp:244</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a2fb6ed4e1f15b65001795da2f135b53a"><div class="ttname"><a href="classmqi_1_1track__t.html#a2fb6ed4e1f15b65001795da2f135b53a">mqi::track_t::stop</a></div><div class="ttdeci">CUDA_HOST_DEVICE void stop()</div><div class="ttdoc">Sets the track&#39;s status to STOPPED, ending its transport.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00266">mqi_track.hpp:266</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a3f936f0ceda5222645db1cee1c2dc184"><div class="ttname"><a href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">mqi::track_t::vtx1</a></div><div class="ttdeci">vertex_t&lt; R &gt; vtx1</div><div class="ttdoc">The post-step vertex (end of the current step).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00079">mqi_track.hpp:79</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a47b0de15eb1624cc562b81caec1457f4"><div class="ttname"><a href="classmqi_1_1track__t.html#a47b0de15eb1624cc562b81caec1457f4">mqi::track_t::dE</a></div><div class="ttdeci">R dE</div><div class="ttdoc">The total energy deposited along the current step (MeV).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00081">mqi_track.hpp:81</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a592d3c8cf52cc8615f55ed749f951c19"><div class="ttname"><a href="classmqi_1_1track__t.html#a592d3c8cf52cc8615f55ed749f951c19">mqi::track_t::local_deposit</a></div><div class="ttdeci">CUDA_HOST_DEVICE void local_deposit(R e)</div><div class="ttdoc">Adds to the locally deposited energy in this step.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00178">mqi_track.hpp:178</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a6ec6ddd5a9d50cbf89372d8f348a0c6d"><div class="ttname"><a href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">mqi::track_t::c_node</a></div><div class="ttdeci">node_t&lt; R &gt; * c_node</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00086">mqi_track.hpp:86</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a75413680b23b9507896be84a32fe276d"><div class="ttname"><a href="classmqi_1_1track__t.html#a75413680b23b9507896be84a32fe276d">mqi::track_t::status</a></div><div class="ttdeci">status_t status</div><div class="ttdoc">The current lifecycle status of the particle (e.g., CREATED, STOPPED).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00073">mqi_track.hpp:73</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a98fcdc2393d97d6fa434875a48dec6ba"><div class="ttname"><a href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">mqi::track_t::vtx0</a></div><div class="ttdeci">vertex_t&lt; R &gt; vtx0</div><div class="ttdoc">The pre-step vertex (start of the current step). Contains position, direction, and energy.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00078">mqi_track.hpp:78</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_ac0ddd58c6eb270f43d091cf853ca355c"><div class="ttname"><a href="classmqi_1_1track__t.html#ac0ddd58c6eb270f43d091cf853ca355c">mqi::track_t::update_post_vertex_direction</a></div><div class="ttdeci">CUDA_HOST_DEVICE void update_post_vertex_direction(const R &amp;theta, const R &amp;phi)</div><div class="ttdoc">Updates the post-step direction after a scattering event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00215">mqi_track.hpp:215</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_a6f82cc668e61e6a8fc148cd8405e4a56"><div class="ttname"><a href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">mqi::vec3::dump</a></div><div class="ttdeci">CUDA_HOST_DEVICE void dump() const</div><div class="ttdoc">Dumps the vector&#39;s components to the console.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00361">mqi_vec.hpp:361</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_a71cd6aab5b41c688d5556ad8d71ef5bb"><div class="ttname"><a href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">mqi::vec3::y</a></div><div class="ttdeci">T y</div><div class="ttdoc">The y-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00182">mqi_vec.hpp:182</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_ab85f3d384f14b933395fc26780853e69"><div class="ttname"><a href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">mqi::vec3::z</a></div><div class="ttdeci">T z</div><div class="ttdoc">The z-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00183">mqi_vec.hpp:183</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_ae25341833906691b642cb13a10d43958"><div class="ttname"><a href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">mqi::vec3::x</a></div><div class="ttdeci">T x</div><div class="ttdoc">The x-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00181">mqi_vec.hpp:181</a></div></div>
<div class="ttc" id="amqi__common_8hpp_html_a43d03f136f9146a99ee64b9fa56f64ce"><div class="ttname"><a href="mqi__common_8hpp.html#a43d03f136f9146a99ee64b9fa56f64ce">CUDA_CONSTANT</a></div><div class="ttdeci">#define CUDA_CONSTANT</div><div class="ttdef"><b>Definition</b> <a href="mqi__common_8hpp_source.html#l00060">mqi_common.hpp:60</a></div></div>
<div class="ttc" id="amqi__common_8hpp_html_ae1a4fe884f889ba6d532db4c1d191eb7"><div class="ttname"><a href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div><div class="ttdeci">#define CUDA_HOST_DEVICE</div><div class="ttdef"><b>Definition</b> <a href="mqi__common_8hpp_source.html#l00054">mqi_common.hpp:54</a></div></div>
<div class="ttc" id="amqi__interaction_8hpp_html"><div class="ttname"><a href="mqi__interaction_8hpp.html">mqi_interaction.hpp</a></div><div class="ttdoc">Defines the abstract base class for all physics interaction models.</div></div>
<div class="ttc" id="anamespacemqi_html"><div class="ttname"><a href="namespacemqi.html">mqi</a></div><div class="ttdef"><b>Definition</b> <a href="mqi__const__1d_8hpp_source.html#l00026">mqi_const_1d.hpp:26</a></div></div>
<div class="ttc" id="anamespacemqi_html_a0afb2cc4c506dc538aa2570a840b8442"><div class="ttname"><a href="namespacemqi.html#a0afb2cc4c506dc538aa2570a840b8442">mqi::mqi_exponential</a></div><div class="ttdeci">CUDA_DEVICE rnd_return&lt; T &gt;::type mqi_exponential(S *rng, T avg, T up)</div><div class="ttdoc">Generates an exponentially distributed random number.</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00262">mqi_math.hpp:262</a></div></div>
<div class="ttc" id="anamespacemqi_html_a0c0a3705b73a3f8ca97a1fbb272ff741"><div class="ttname"><a href="namespacemqi.html#a0c0a3705b73a3f8ca97a1fbb272ff741">mqi::mqi_exp</a></div><div class="ttdeci">CUDA_DEVICE T mqi_exp(T s)</div><div class="ttdoc">Calculates the base-e exponential. Wrapper for exp or expf.</div></div>
<div class="ttc" id="anamespacemqi_html_a3056e4aa71c04575840237dbfe35b397"><div class="ttname"><a href="namespacemqi.html#a3056e4aa71c04575840237dbfe35b397">mqi::intpl1d</a></div><div class="ttdeci">CUDA_DEVICE T intpl1d(T x, T x0, T x1, T y0, T y1)</div><div class="ttdoc">Performs 1D linear interpolation.</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00043">mqi_math.hpp:43</a></div></div>
<div class="ttc" id="anamespacemqi_html_a3fd672c3dd5233871d908ca2b7faf8e0acb17d075b3b3e9b5c056e9aaf9e28539"><div class="ttname"><a href="namespacemqi.html#a3fd672c3dd5233871d908ca2b7faf8e0acb17d075b3b3e9b5c056e9aaf9e28539">mqi::PO_E</a></div><div class="ttdeci">@ PO_E</div><div class="ttdoc">Step was limited by a proton-oxygen elastic scattering event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00036">mqi_track.hpp:36</a></div></div>
<div class="ttc" id="anamespacemqi_html_a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e"><div class="ttname"><a href="namespacemqi.html#a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e">mqi::CREATED</a></div><div class="ttdeci">@ CREATED</div><div class="ttdoc">The track has been created but not yet transported.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00047">mqi_track.hpp:47</a></div></div>
<div class="ttc" id="anamespacemqi_html_a5e50016c30bdbbfe3f1085ab19f87ad0"><div class="ttname"><a href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi::mqi_rng</a></div><div class="ttdeci">std::default_random_engine mqi_rng</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00608">mqi_math.hpp:608</a></div></div>
<div class="ttc" id="anamespacemqi_html_a91a6ed407b1f63e7150657ef1aef1194"><div class="ttname"><a href="namespacemqi.html#a91a6ed407b1f63e7150657ef1aef1194">mqi::mqi_acos</a></div><div class="ttdeci">CUDA_DEVICE T mqi_acos(T s)</div><div class="ttdoc">Calculates the arc cosine. Wrapper for acos or acosf.</div></div>
<div class="ttc" id="anamespacemqi_html_ace7aec8e333f369896fe5495ecaebecc"><div class="ttname"><a href="namespacemqi.html#ace7aec8e333f369896fe5495ecaebecc">mqi::cs_po_e_g4_table</a></div><div class="ttdeci">CUDA_CONSTANT const float cs_po_e_g4_table[600]</div><div class="ttdoc">Lookup table for proton-oxygen elastic scattering cross-sections.</div><div class="ttdef"><b>Definition</b> <a href="#l00015">mqi_po_elastic.hpp:15</a></div></div>
<div class="ttc" id="anamespacemqi_html_add466ef65529d5cbcb7b8a1ee9b32778"><div class="ttname"><a href="namespacemqi.html#add466ef65529d5cbcb7b8a1ee9b32778">mqi::mqi_uniform</a></div><div class="ttdeci">CUDA_DEVICE rnd_return&lt; T &gt;::type mqi_uniform(S *rng)</div><div class="ttdoc">Generates a uniformly distributed random number in [0, 1).</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00245">mqi_math.hpp:245</a></div></div>
<div class="ttc" id="anamespacemqi_html_aef88923de451fcfef0ae37638919075f"><div class="ttname"><a href="namespacemqi.html#aef88923de451fcfef0ae37638919075f">mqi::mqi_sqrt</a></div><div class="ttdeci">CUDA_HOST_DEVICE T mqi_sqrt(T s)</div><div class="ttdoc">Calculates the square root. Wrapper for sqrt (double) or sqrtf (float).</div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_a460bf0e1c8220ffd3d43b6f9f0eb77b2"><div class="ttname"><a href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">mqi::vertex_t::dir</a></div><div class="ttdeci">vec3&lt; T &gt; dir</div><div class="ttdoc">Direction (as a unit vector) of the particle&#39;s momentum.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00022">mqi_vertex.hpp:22</a></div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_a7c579c9150537b19bc1f5fe52893df6c"><div class="ttname"><a href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">mqi::vertex_t::ke</a></div><div class="ttdeci">T ke</div><div class="ttdoc">Kinetic energy of the particle at the vertex.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00020">mqi_vertex.hpp:20</a></div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_aad1c03cda0a634e9ec666547cb4e0f60"><div class="ttname"><a href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">mqi::vertex_t::pos</a></div><div class="ttdeci">vec3&lt; T &gt; pos</div><div class="ttdoc">Position of the particle in 3D space.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00021">mqi_vertex.hpp:21</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_e914ee4d4a44400f1fdb170cb4ead18a.html">base</a></li><li class="navelem"><a href="mqi__po__elastic_8hpp.html">mqi_po_elastic.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
