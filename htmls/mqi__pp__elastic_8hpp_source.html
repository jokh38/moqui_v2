<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moqui: base/mqi_pp_elastic.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Moqui
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('mqi__pp__elastic_8hpp_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mqi_pp_elastic.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="mqi__pp__elastic_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef MQI_PP_ELASTIC_HPP</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define MQI_PP_ELASTIC_HPP</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;<a class="code" href="mqi__interaction_8hpp.html">moqui/base/mqi_interaction.hpp</a>&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacemqi.html">mqi</a></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span>{</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span></div>
<div class="foldopen" id="foldopen00011" data-start="{" data-end="};">
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno"><a class="line" href="namespacemqi.html#a594f905ab0e6de5762696db510ef49f1">   11</a></span><a class="code hl_define" href="mqi__common_8hpp.html#a43d03f136f9146a99ee64b9fa56f64ce">CUDA_CONSTANT</a> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="namespacemqi.html#a594f905ab0e6de5762696db510ef49f1">cs_pp_e_g4_table</a>[600] = {</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>    0.00000, 2.54109, 4.64796, 4.93231, 4.77709, 4.50612, 4.21575, 3.93742, 3.68050, 3.44700,</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>    3.23557, 3.04422, 2.87160, 2.71438, 2.57187, 2.44140, 2.32164, 2.21191, 2.11088, 2.01722,</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>    1.93091, 1.85062, 1.77568, 1.70610, 1.64053, 1.57965, 1.52211, 1.46859, 1.41774, 1.37023,</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>    1.32474, 1.28192, 1.24178, 1.20364, 1.16684, 1.13272, 1.09993, 1.06849, 1.03905, 1.01028,</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>    0.98352, 0.95742, 0.93267, 0.90858, 0.88584, 0.86443, 0.84368, 0.82361, 0.80421, 0.78548,</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    0.76808, 0.75069, 0.73463, 0.71857, 0.70318, 0.68846, 0.67441, 0.66076, 0.64758, 0.63480,</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    0.62249, 0.61058, 0.59901, 0.58790, 0.57713, 0.56669, 0.55659, 0.54676, 0.53732, 0.52809,</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    0.51919, 0.51056, 0.50220, 0.49403, 0.48614, 0.47844, 0.47102, 0.46379, 0.45677, 0.44994,</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    0.44332, 0.43683, 0.43054, 0.42445, 0.41850, 0.41268, 0.40706, 0.40157, 0.39622, 0.39107,</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    0.38598, 0.38103, 0.37621, 0.37153, 0.36698, 0.36250, 0.35815, 0.35393, 0.34978, 0.34577,</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    0.34182, 0.33794, 0.33420, 0.33058, 0.32697, 0.32349, 0.32008, 0.31673, 0.31345, 0.31031,</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    0.30723, 0.30415, 0.30121, 0.29827, 0.29546, 0.29271, 0.28997, 0.28729, 0.28475, 0.28221,</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    0.27973, 0.27726, 0.27492, 0.27257, 0.27030, 0.26809, 0.26595, 0.26381, 0.26167, 0.25966,</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    0.25765, 0.25571, 0.25377, 0.25190, 0.25009, 0.24829, 0.24648, 0.24474, 0.24307, 0.24140,</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    0.23979, 0.23819, 0.23665, 0.23511, 0.23357, 0.23210, 0.23069, 0.22929, 0.22788, 0.22654,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    0.22521, 0.22387, 0.22260, 0.22139, 0.22012, 0.21892, 0.21771, 0.21657, 0.21544, 0.21430,</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    0.21323, 0.21216, 0.21109, 0.21008, 0.20908, 0.20808, 0.20707, 0.20614, 0.20520, 0.20426,</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    0.20333, 0.20246, 0.20159, 0.20072, 0.19992, 0.19905, 0.19824, 0.19744, 0.19670, 0.19590,</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    0.19516, 0.19443, 0.19369, 0.19296, 0.19229, 0.19162, 0.19095, 0.19028, 0.18961, 0.18901,</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    0.18834, 0.18774, 0.18714, 0.18653, 0.18593, 0.18540, 0.18486, 0.18426, 0.18372, 0.18473,</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>    0.18419, 0.18366, 0.18312, 0.18265, 0.18212, 0.18165, 0.18118, 0.18071, 0.18024, 0.17978,</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    0.17931, 0.17891, 0.17844, 0.17804, 0.17764, 0.17723, 0.17683, 0.17643, 0.17603, 0.17563,</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    0.17529, 0.17489, 0.17456, 0.17422, 0.17389, 0.17349, 0.17315, 0.17282, 0.17255, 0.17222,</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    0.17188, 0.17161, 0.17128, 0.17101, 0.17068, 0.17041, 0.17014, 0.16987, 0.16961, 0.16934,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    0.16907, 0.16880, 0.16854, 0.16827, 0.16807, 0.16780, 0.16760, 0.16733, 0.16713, 0.16686,</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    0.16666, 0.16646, 0.16626, 0.16606, 0.16586, 0.16566, 0.16546, 0.16526, 0.16506, 0.16486,</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    0.16466, 0.16452, 0.16432, 0.16419, 0.16399, 0.16379, 0.16365, 0.16352, 0.16332, 0.16318,</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    0.16305, 0.16285, 0.16272, 0.16258, 0.16245, 0.16231, 0.16218, 0.16205, 0.16191, 0.16178,</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    0.16164, 0.16151, 0.16138, 0.16124, 0.16118, 0.16104, 0.16091, 0.16084, 0.16071, 0.16057,</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    0.16051, 0.16037, 0.16031, 0.16017, 0.16011, 0.15997, 0.15991, 0.15977, 0.15970, 0.15964,</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    0.15950, 0.15944, 0.15937, 0.15930, 0.15917, 0.15910, 0.15904, 0.15897, 0.15890, 0.15883,</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    0.15877, 0.15870, 0.15857, 0.15850, 0.15843, 0.15837, 0.15837, 0.15830, 0.15823, 0.15817,</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    0.15810, 0.15803, 0.15797, 0.15790, 0.15790, 0.15783, 0.15776, 0.15770, 0.15763, 0.15763,</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    0.15756, 0.15750, 0.15750, 0.15743, 0.15736, 0.15736, 0.15730, 0.15723, 0.15723, 0.15716,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    0.15710, 0.15710, 0.15703, 0.15703, 0.15696, 0.15696, 0.15689, 0.15689, 0.15683, 0.15683,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    0.15676, 0.15676, 0.15669, 0.15669, 0.15669, 0.15663, 0.15663, 0.15656, 0.15656, 0.15656,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    0.15649, 0.15649, 0.15643, 0.15643, 0.15643, 0.15636, 0.15636, 0.15636, 0.15629, 0.15629,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    0.15629, 0.15629, 0.15623, 0.15623, 0.15623, 0.15616, 0.15616, 0.15616, 0.15616, 0.15609,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    0.15609, 0.15609, 0.15609, 0.15609, 0.15602, 0.15602, 0.15602, 0.15602, 0.15602, 0.15596,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    0.15596, 0.15596, 0.15596, 0.15596, 0.15596, 0.15589, 0.15589, 0.15589, 0.15589, 0.15589,</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    0.15589, 0.15589, 0.15589, 0.15582, 0.15582, 0.15582, 0.15582, 0.15582, 0.15582, 0.15582,</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    0.15582, 0.15582, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15562, 0.15562,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15562,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    0.15562, 0.15562, 0.15562, 0.15562, 0.15562, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569, 0.15569,</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    0.15569, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576, 0.15576,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    0.15582, 0.15582, 0.15582, 0.15582, 0.15582, 0.15582, 0.15589, 0.15589, 0.15589, 0.15589,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    0.15589, 0.15589, 0.15596, 0.15596, 0.15596, 0.15596, 0.15596, 0.15602, 0.15602, 0.15602,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    0.15602, 0.15602, 0.15609, 0.15609, 0.15609, 0.15609, 0.15616, 0.15616, 0.15616, 0.15616,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    0.15623, 0.15623, 0.15623, 0.15623, 0.15629, 0.15629, 0.15629, 0.15636, 0.15636, 0.15636,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    0.15636, 0.15643, 0.15643, 0.15643, 0.15649, 0.15649, 0.15649, 0.15656, 0.15656, 0.15656,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    0.15656, 0.15663, 0.15663, 0.15663, 0.15669, 0.15669, 0.15676, 0.15676, 0.15676, 0.15683,</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    0.15683, 0.15683, 0.15689, 0.15689, 0.15689, 0.15696, 0.15696, 0.15703, 0.15703, 0.15703</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>};</div>
</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> R&gt;</div>
<div class="foldopen" id="foldopen00080" data-start="{" data-end="};">
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic.html">   80</a></span><span class="keyword">class </span><a class="code hl_class" href="classmqi_1_1pp__elastic.html">pp_elastic</a> : <span class="keyword">public</span> <a class="code hl_function" href="classmqi_1_1interaction.html#ae66185d63971e11abd3ffd5d91d353cc">interaction</a>&lt;R, mqi::PROTON&gt;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>{</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keyword">virtual</span> R</div>
<div class="foldopen" id="foldopen00092" data-start="{" data-end="}">
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic.html#a29f78fb8081407d25d882a0b148936d8">   92</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic.html#a29f78fb8081407d25d882a0b148936d8">cross_section</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities&lt;R&gt;</a>&amp; rel, <span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp; mat) {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        R cs = 0;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="keywordflow">if</span> (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &gt; 10.0 &amp;&amp; rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &lt; 300) {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            cs = 0.315 * <a class="code hl_function" href="namespacemqi.html#a3da16fe5ac4fb84d05d6d1620464667e">mqi::mqi_pow</a>(rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>, R(-1.126));</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>            cs += 3.78 * 1e-6 * rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        }</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        cs *= mat.<a class="code hl_variable" href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">rho_mass</a>;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="keywordflow">return</span> cs;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    }</div>
</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00114" data-start="{" data-end="}">
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic.html#af554103e99845928228592e285a3d766">  114</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic.html#af554103e99845928228592e285a3d766">along_step</a>(<a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a>&amp;       trk,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>               <a class="code hl_class" href="classmqi_1_1track__stack__t.html">track_stack_t&lt;R&gt;</a>&amp; stk,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>               <a class="code hl_typedef" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a>*          rng,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>               <span class="keyword">const</span> R           len,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>               <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp;    mat) {</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        ;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    }</div>
</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>};</div>
</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> R&gt;</div>
<div class="foldopen" id="foldopen00131" data-start="{" data-end="};">
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html">  131</a></span><span class="keyword">class </span><a class="code hl_function" href="classmqi_1_1pp__elastic__tabulated.html#a4af79a5ece6eb8f852608d22d34084b2">pp_elastic_tabulated</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmqi_1_1pp__elastic.html">pp_elastic</a>&lt;R&gt;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>{</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">  134</a></span>    <span class="keyword">const</span> R* <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a>;  </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">  135</a></span>    R        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">Ek_min</a>;    </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a0598810c6727beece5c6c008f2471dce">  136</a></span>    R        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a0598810c6727beece5c6c008f2471dce">Ek_max</a>;    </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">  137</a></span>    R        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">dEk</a>;       </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="foldopen" id="foldopen00148" data-start="{" data-end="}">
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a4af79a5ece6eb8f852608d22d34084b2">  148</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic__tabulated.html#a4af79a5ece6eb8f852608d22d34084b2">pp_elastic_tabulated</a>(R m, R M, R s, <span class="keyword">const</span> R* p) : <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a>(p) {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">Ek_min</a> = m;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a0598810c6727beece5c6c008f2471dce">Ek_max</a> = M;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">dEk</a>    = s;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    }</div>
</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="foldopen" id="foldopen00158" data-start="{" data-end="}">
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a56443fe7edf4eb288d514c332cd3f485">  158</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic__tabulated.html#a56443fe7edf4eb288d514c332cd3f485">~pp_elastic_tabulated</a>() {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    }</div>
</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00177" data-start="{" data-end="}">
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a0571b59ea2a1d58ea70415239f0e4e74">  177</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic__tabulated.html#a0571b59ea2a1d58ea70415239f0e4e74">post_step</a>(<a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a>&amp;       trk,</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>              <a class="code hl_class" href="classmqi_1_1track__stack__t.html">track_stack_t&lt;R&gt;</a>&amp; stk,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>              <a class="code hl_typedef" href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi_rng</a>*          rng,</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>              <span class="keyword">const</span> R           len,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>              <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp;    mat,</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>              <span class="keywordtype">bool</span>              score_local_deposit) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">mqi::relativistic_quantities&lt;R&gt;</a> rel(trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>, this-&gt;units.Mp);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        R min_value = this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#af2d98eec57ea0ae65da70863be86588e">Tp_cut</a> / rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        R u         = <a class="code hl_function" href="namespacemqi.html#add466ef65529d5cbcb7b8a1ee9b32778">mqi::mqi_uniform&lt;R&gt;</a>(rng) * (1.0 - 2.0 * min_value) + min_value;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        assert(u &lt; 1);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        R E1 = rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a894293e664d867b6e2dece96110c6322">Et</a>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        R dE = rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> * u;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        R E3 = (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> - dE) + this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        R E4 = dE + this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        R P1 = rel.<a class="code hl_function" href="classmqi_1_1relativistic__quantities.html#a82d23c0dd2ed93bf817ef027677d4f56">momentum</a>();</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        R P3 = <a class="code hl_function" href="namespacemqi.html#aef88923de451fcfef0ae37638919075f">mqi::mqi_sqrt</a>(E3 * E3 - this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp_sq);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        R P4 = <a class="code hl_function" href="namespacemqi.html#aef88923de451fcfef0ae37638919075f">mqi::mqi_sqrt</a>(E4 * E4 - this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp_sq);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        R cos_th3 = E1 * E3 - this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp_sq - this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp * (E1 - E3);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        cos_th3 /= (P1 * P3);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        R cos_th34 = E3 * E4 - E1 * this-&gt;<a class="code hl_variable" href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">units</a>.Mp;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        cos_th34 /= (P3 * P4);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <span class="keywordflow">if</span> (cos_th3 &gt; 1.0)</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            cos_th3 = 1.0;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cos_th3 &lt; -1.0)</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            cos_th3 = -1.0;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <span class="keywordflow">if</span> (cos_th34 &gt; 1.0)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            cos_th34 = 1.0;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cos_th34 &lt; -1.0)</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            cos_th34 = -1.0;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>        R th3 = <a class="code hl_function" href="namespacemqi.html#a91a6ed407b1f63e7150657ef1aef1194">mqi::mqi_acos&lt;R&gt;</a>(cos_th3);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        R th4 = th3 - <a class="code hl_function" href="namespacemqi.html#a91a6ed407b1f63e7150657ef1aef1194">mqi::mqi_acos&lt;R&gt;</a>(cos_th34);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        R phi = 2.0 * M_PI * <a class="code hl_function" href="namespacemqi.html#add466ef65529d5cbcb7b8a1ee9b32778">mqi::mqi_uniform&lt;R&gt;</a>(rng);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        assert(dE &lt; trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        assert(dE &gt;= 0);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        trk.<a class="code hl_function" href="classmqi_1_1track__t.html#a2eb7b29246c1aea2981446380531c1f0">update_post_vertex_energy</a>(dE);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        trk.<a class="code hl_function" href="classmqi_1_1track__t.html#ac0ddd58c6eb270f43d091cf853ca355c">update_post_vertex_direction</a>(th3, phi);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        <a class="code hl_class" href="classmqi_1_1track__t.html">track_t&lt;R&gt;</a> daughter = trk;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a47b0de15eb1624cc562b81caec1457f4">dE</a>         = 0;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a0c1137c7a9546caacacf3a31d1961f24">local_dE</a>   = 0;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a0b8b47567a54aa7cac80fafe42c87ab4">primary</a>    = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a069868249224d338446bf27d5aaada96">process</a>    = <a class="code hl_enumvalue" href="namespacemqi.html#a3fd672c3dd5233871d908ca2b7faf8e0a55eb0fa19cfb266e3482dc7325612c65">mqi::PP_E</a>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>    = dE;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>    = dE;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a75413680b23b9507896be84a32fe276d">status</a>     = <a class="code hl_enumvalue" href="namespacemqi.html#a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e">CREATED</a>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        daughter.<a class="code hl_function" href="classmqi_1_1track__t.html#ac0ddd58c6eb270f43d091cf853ca355c">update_post_vertex_direction</a>(th4, phi);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                              (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                            trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd *</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>                              (daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a> - trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector) +</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>                            trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;translation_vector;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a> = trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">c_node</a>-&gt;geo-&gt;rotation_matrix_fwd * daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="preprocessor">#if !defined(__CUDACC__)</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        <span class="keywordflow">if</span> (std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) || std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) ||</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>)) {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            printf(<span class="stringliteral">&quot;inside pp_e\n&quot;</span>);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            printf(<span class="stringliteral">&quot;th4 %f phi %f\n&quot;</span>, th4, phi);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            printf(<span class="stringliteral">&quot;po_e ke: %f\n&quot;</span>, trk.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">ke</a>);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            printf(<span class="stringliteral">&quot;1 &quot;</span>);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            printf(<span class="stringliteral">&quot;2 &quot;</span>);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>            printf(<span class="stringliteral">&quot;3 &quot;</span>);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>            printf(<span class="stringliteral">&quot;4 &quot;</span>);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>            daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">dump</a>();</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        }</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        assert(!std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) &amp;&amp; !std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) &amp;&amp;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>               !std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>));</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        assert(!std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">x</a>) &amp;&amp; !std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">y</a>) &amp;&amp;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>               !std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">pos</a>.<a class="code hl_variable" href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">z</a>));</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        assert(!std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">vtx0</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a88e9972678dec2310a6ca61b5a8c213c">norm</a>()));</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        assert(!std::isnan(daughter.<a class="code hl_variable" href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">vtx1</a>.<a class="code hl_variable" href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">dir</a>.<a class="code hl_function" href="classmqi_1_1vec3.html#a88e9972678dec2310a6ca61b5a8c213c">norm</a>()));</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        stk.<a class="code hl_function" href="classmqi_1_1track__stack__t.html#a54dd3bc633b0c06c1ffa671a2e219d9e">push_secondary</a>(daughter);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    }</div>
</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <a class="code hl_define" href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <span class="keyword">virtual</span> R</div>
<div class="foldopen" id="foldopen00287" data-start="{" data-end="}">
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno"><a class="line" href="classmqi_1_1pp__elastic__tabulated.html#a00c8873253cf6d6d7730a249e8f72190">  287</a></span>    <a class="code hl_function" href="classmqi_1_1pp__elastic__tabulated.html#a00c8873253cf6d6d7730a249e8f72190">cross_section</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1relativistic__quantities.html">relativistic_quantities&lt;R&gt;</a>&amp; rel, <span class="keyword">const</span> <a class="code hl_class" href="classmqi_1_1material__t.html">material_t&lt;R&gt;</a>&amp; mat) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        R cs = 0;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="keywordflow">if</span> (rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &gt;= <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">Ek_min</a> &amp;&amp; rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> &lt;= <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a0598810c6727beece5c6c008f2471dce">Ek_max</a>) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            uint16_t idx0 = uint16_t((rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a> - <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">Ek_min</a>) / <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">dEk</a>);   <span class="comment">//0 - 598</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            uint16_t idx1 = idx0 + 1;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            R        x0   = <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">Ek_min</a> + idx0 * <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">dEk</a>;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            R        x1   = x0 + 0.5;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            cs            = <a class="code hl_function" href="namespacemqi.html#a3056e4aa71c04575840237dbfe35b397">mqi::intpl1d&lt;R&gt;</a>(rel.<a class="code hl_variable" href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">Ek</a>, x0, x1, <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a>[idx0], <a class="code hl_variable" href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">cs_table</a>[idx1]);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        cs *= mat.<a class="code hl_variable" href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">rho_mass</a>;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        <span class="keywordflow">return</span> cs;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    }</div>
</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>};</div>
</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>}   <span class="comment">// namespace mqi</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassmqi_1_1interaction_html_a4c87b1945089a1884d8052089e552aaf"><div class="ttname"><a href="classmqi_1_1interaction.html#a4c87b1945089a1884d8052089e552aaf">mqi::interaction&lt; R, mqi::PROTON &gt;::units</a></div><div class="ttdeci">const physics_constants&lt; R &gt; units</div><div class="ttdef"><b>Definition</b> <a href="mqi__interaction_8hpp_source.html#l00040">mqi_interaction.hpp:40</a></div></div>
<div class="ttc" id="aclassmqi_1_1interaction_html_ae66185d63971e11abd3ffd5d91d353cc"><div class="ttname"><a href="classmqi_1_1interaction.html#ae66185d63971e11abd3ffd5d91d353cc">mqi::interaction&lt; R, mqi::PROTON &gt;::interaction</a></div><div class="ttdeci">CUDA_HOST_DEVICE interaction()</div><div class="ttdef"><b>Definition</b> <a href="mqi__interaction_8hpp_source.html#l00059">mqi_interaction.hpp:59</a></div></div>
<div class="ttc" id="aclassmqi_1_1interaction_html_af2d98eec57ea0ae65da70863be86588e"><div class="ttname"><a href="classmqi_1_1interaction.html#af2d98eec57ea0ae65da70863be86588e">mqi::interaction&lt; R, mqi::PROTON &gt;::Tp_cut</a></div><div class="ttdeci">R Tp_cut</div><div class="ttdef"><b>Definition</b> <a href="mqi__interaction_8hpp_source.html#l00052">mqi_interaction.hpp:52</a></div></div>
<div class="ttc" id="aclassmqi_1_1material__t_html"><div class="ttname"><a href="classmqi_1_1material__t.html">mqi::material_t</a></div><div class="ttdoc">water_t</div><div class="ttdef"><b>Definition</b> <a href="materials_2mqi__material_8hpp_source.html#l00044">mqi_material.hpp:45</a></div></div>
<div class="ttc" id="aclassmqi_1_1material__t_html_aab85e9eede73428b945e31b13e2e571e"><div class="ttname"><a href="classmqi_1_1material__t.html#aab85e9eede73428b945e31b13e2e571e">mqi::material_t::rho_mass</a></div><div class="ttdeci">R rho_mass</div><div class="ttdoc">Electron density in electrons/mm^3.</div><div class="ttdef"><b>Definition</b> <a href="materials_2mqi__material_8hpp_source.html#l00053">mqi_material.hpp:53</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a00c8873253cf6d6d7730a249e8f72190"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a00c8873253cf6d6d7730a249e8f72190">mqi::pp_elastic_tabulated::cross_section</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE R cross_section(const relativistic_quantities&lt; R &gt; &amp;rel, const material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">Calculates the macroscopic cross-section using linear interpolation on the tabulated data.</div><div class="ttdef"><b>Definition</b> <a href="#l00287">mqi_pp_elastic.hpp:287</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a0571b59ea2a1d58ea70415239f0e4e74"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a0571b59ea2a1d58ea70415239f0e4e74">mqi::pp_elastic_tabulated::post_step</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE void post_step(track_t&lt; R &gt; &amp;trk, track_stack_t&lt; R &gt; &amp;stk, mqi_rng *rng, const R len, material_t&lt; R &gt; &amp;mat, bool score_local_deposit)</div><div class="ttdoc">Simulates the interaction after a transport step.</div><div class="ttdef"><b>Definition</b> <a href="#l00177">mqi_pp_elastic.hpp:177</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a0598810c6727beece5c6c008f2471dce"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a0598810c6727beece5c6c008f2471dce">mqi::pp_elastic_tabulated::Ek_max</a></div><div class="ttdeci">R Ek_max</div><div class="ttdoc">Maximum kinetic energy in the cross-section table.</div><div class="ttdef"><b>Definition</b> <a href="#l00136">mqi_pp_elastic.hpp:136</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a4af79a5ece6eb8f852608d22d34084b2"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a4af79a5ece6eb8f852608d22d34084b2">mqi::pp_elastic_tabulated::pp_elastic_tabulated</a></div><div class="ttdeci">CUDA_HOST_DEVICE pp_elastic_tabulated(R m, R M, R s, const R *p)</div><div class="ttdoc">Constructs a tabulated p-p elastic interaction object.</div><div class="ttdef"><b>Definition</b> <a href="#l00148">mqi_pp_elastic.hpp:148</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a56443fe7edf4eb288d514c332cd3f485"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a56443fe7edf4eb288d514c332cd3f485">mqi::pp_elastic_tabulated::~pp_elastic_tabulated</a></div><div class="ttdeci">CUDA_HOST_DEVICE ~pp_elastic_tabulated()</div><div class="ttdoc">Destructor. Nullifies the pointer to the cross-section table.</div><div class="ttdef"><b>Definition</b> <a href="#l00158">mqi_pp_elastic.hpp:158</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a6bc73128d1b81ad3f48ab776a037b9e2"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a6bc73128d1b81ad3f48ab776a037b9e2">mqi::pp_elastic_tabulated::dEk</a></div><div class="ttdeci">R dEk</div><div class="ttdoc">Energy step size in the cross-section table.</div><div class="ttdef"><b>Definition</b> <a href="#l00137">mqi_pp_elastic.hpp:137</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_a831902619ea47baf583c70da6c22917b"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#a831902619ea47baf583c70da6c22917b">mqi::pp_elastic_tabulated::Ek_min</a></div><div class="ttdeci">R Ek_min</div><div class="ttdoc">Minimum kinetic energy in the cross-section table.</div><div class="ttdef"><b>Definition</b> <a href="#l00135">mqi_pp_elastic.hpp:135</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic__tabulated_html_af89bddd331d1d9e34a5917c84a33dd3e"><div class="ttname"><a href="classmqi_1_1pp__elastic__tabulated.html#af89bddd331d1d9e34a5917c84a33dd3e">mqi::pp_elastic_tabulated::cs_table</a></div><div class="ttdeci">const R * cs_table</div><div class="ttdoc">Pointer to the tabulated cross-section data.</div><div class="ttdef"><b>Definition</b> <a href="#l00134">mqi_pp_elastic.hpp:134</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic_html"><div class="ttname"><a href="classmqi_1_1pp__elastic.html">mqi::pp_elastic</a></div><div class="ttdoc">Represents the elastic interaction between two protons.</div><div class="ttdef"><b>Definition</b> <a href="#l00080">mqi_pp_elastic.hpp:81</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic_html_a29f78fb8081407d25d882a0b148936d8"><div class="ttname"><a href="classmqi_1_1pp__elastic.html#a29f78fb8081407d25d882a0b148936d8">mqi::pp_elastic::cross_section</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE R cross_section(const relativistic_quantities&lt; R &gt; &amp;rel, const material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">Calculates the macroscopic cross-section for p-p elastic scattering.</div><div class="ttdef"><b>Definition</b> <a href="#l00092">mqi_pp_elastic.hpp:92</a></div></div>
<div class="ttc" id="aclassmqi_1_1pp__elastic_html_af554103e99845928228592e285a3d766"><div class="ttname"><a href="classmqi_1_1pp__elastic.html#af554103e99845928228592e285a3d766">mqi::pp_elastic::along_step</a></div><div class="ttdeci">virtual CUDA_HOST_DEVICE void along_step(track_t&lt; R &gt; &amp;trk, track_stack_t&lt; R &gt; &amp;stk, mqi_rng *rng, const R len, material_t&lt; R &gt; &amp;mat)</div><div class="ttdoc">A virtual function to handle actions during a simulation step.</div><div class="ttdef"><b>Definition</b> <a href="#l00114">mqi_pp_elastic.hpp:114</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html">mqi::relativistic_quantities</a></div><div class="ttdoc">A struct to calculate and store essential relativistic quantities for a particle.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00028">mqi_relativistic_quantities.hpp:29</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_a0680900ad1acc19d12c7ec912d250649"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#a0680900ad1acc19d12c7ec912d250649">mqi::relativistic_quantities::Ek</a></div><div class="ttdeci">R Ek</div><div class="ttdoc">The kinetic energy of the particle in MeV.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00036">mqi_relativistic_quantities.hpp:36</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_a82d23c0dd2ed93bf817ef027677d4f56"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#a82d23c0dd2ed93bf817ef027677d4f56">mqi::relativistic_quantities::momentum</a></div><div class="ttdeci">CUDA_HOST_DEVICE R momentum()</div><div class="ttdoc">Calculates the relativistic momentum of the particle.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00094">mqi_relativistic_quantities.hpp:94</a></div></div>
<div class="ttc" id="aclassmqi_1_1relativistic__quantities_html_a894293e664d867b6e2dece96110c6322"><div class="ttname"><a href="classmqi_1_1relativistic__quantities.html#a894293e664d867b6e2dece96110c6322">mqi::relativistic_quantities::Et</a></div><div class="ttdeci">R Et</div><div class="ttdoc">The total energy of the particle (kinetic energy + rest mass energy), E_total = Ek + m0*c^2.</div><div class="ttdef"><b>Definition</b> <a href="mqi__relativistic__quantities_8hpp_source.html#l00034">mqi_relativistic_quantities.hpp:34</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__stack__t_html"><div class="ttname"><a href="classmqi_1_1track__stack__t.html">mqi::track_stack_t</a></div><div class="ttdoc">A simple, fixed-size stack for managing secondary particle tracks.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track__stack_8hpp_source.html#l00036">mqi_track_stack.hpp:37</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__stack__t_html_a54dd3bc633b0c06c1ffa671a2e219d9e"><div class="ttname"><a href="classmqi_1_1track__stack__t.html#a54dd3bc633b0c06c1ffa671a2e219d9e">mqi::track_stack_t::push_secondary</a></div><div class="ttdeci">CUDA_HOST_DEVICE void push_secondary(const track_t&lt; R &gt; &amp;trk)</div><div class="ttdoc">Pushes a secondary track onto the top of the stack.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track__stack_8hpp_source.html#l00077">mqi_track_stack.hpp:77</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html"><div class="ttname"><a href="classmqi_1_1track__t.html">mqi::track_t</a></div><div class="ttdoc">Represents a particle&#39;s state and its path through the simulation.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00069">mqi_track.hpp:70</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a069868249224d338446bf27d5aaada96"><div class="ttname"><a href="classmqi_1_1track__t.html#a069868249224d338446bf27d5aaada96">mqi::track_t::process</a></div><div class="ttdeci">process_t process</div><div class="ttdoc">The physics or geometry process that limited the last step.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00074">mqi_track.hpp:74</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a0b8b47567a54aa7cac80fafe42c87ab4"><div class="ttname"><a href="classmqi_1_1track__t.html#a0b8b47567a54aa7cac80fafe42c87ab4">mqi::track_t::primary</a></div><div class="ttdeci">bool primary</div><div class="ttdoc">Flag indicating if this is a primary particle (true) or a secondary (false).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00075">mqi_track.hpp:75</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a0c1137c7a9546caacacf3a31d1961f24"><div class="ttname"><a href="classmqi_1_1track__t.html#a0c1137c7a9546caacacf3a31d1961f24">mqi::track_t::local_dE</a></div><div class="ttdeci">R local_dE</div><div class="ttdoc">The energy deposited locally from secondaries below tracking cuts (MeV).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00082">mqi_track.hpp:82</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a2eb7b29246c1aea2981446380531c1f0"><div class="ttname"><a href="classmqi_1_1track__t.html#a2eb7b29246c1aea2981446380531c1f0">mqi::track_t::update_post_vertex_energy</a></div><div class="ttdeci">CUDA_HOST_DEVICE void update_post_vertex_energy(const R &amp;e)</div><div class="ttdoc">Updates the post-step kinetic energy after an energy loss event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00244">mqi_track.hpp:244</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a3f936f0ceda5222645db1cee1c2dc184"><div class="ttname"><a href="classmqi_1_1track__t.html#a3f936f0ceda5222645db1cee1c2dc184">mqi::track_t::vtx1</a></div><div class="ttdeci">vertex_t&lt; R &gt; vtx1</div><div class="ttdoc">The post-step vertex (end of the current step).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00079">mqi_track.hpp:79</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a47b0de15eb1624cc562b81caec1457f4"><div class="ttname"><a href="classmqi_1_1track__t.html#a47b0de15eb1624cc562b81caec1457f4">mqi::track_t::dE</a></div><div class="ttdeci">R dE</div><div class="ttdoc">The total energy deposited along the current step (MeV).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00081">mqi_track.hpp:81</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a6ec6ddd5a9d50cbf89372d8f348a0c6d"><div class="ttname"><a href="classmqi_1_1track__t.html#a6ec6ddd5a9d50cbf89372d8f348a0c6d">mqi::track_t::c_node</a></div><div class="ttdeci">node_t&lt; R &gt; * c_node</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00086">mqi_track.hpp:86</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a75413680b23b9507896be84a32fe276d"><div class="ttname"><a href="classmqi_1_1track__t.html#a75413680b23b9507896be84a32fe276d">mqi::track_t::status</a></div><div class="ttdeci">status_t status</div><div class="ttdoc">The current lifecycle status of the particle (e.g., CREATED, STOPPED).</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00073">mqi_track.hpp:73</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_a98fcdc2393d97d6fa434875a48dec6ba"><div class="ttname"><a href="classmqi_1_1track__t.html#a98fcdc2393d97d6fa434875a48dec6ba">mqi::track_t::vtx0</a></div><div class="ttdeci">vertex_t&lt; R &gt; vtx0</div><div class="ttdoc">The pre-step vertex (start of the current step). Contains position, direction, and energy.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00078">mqi_track.hpp:78</a></div></div>
<div class="ttc" id="aclassmqi_1_1track__t_html_ac0ddd58c6eb270f43d091cf853ca355c"><div class="ttname"><a href="classmqi_1_1track__t.html#ac0ddd58c6eb270f43d091cf853ca355c">mqi::track_t::update_post_vertex_direction</a></div><div class="ttdeci">CUDA_HOST_DEVICE void update_post_vertex_direction(const R &amp;theta, const R &amp;phi)</div><div class="ttdoc">Updates the post-step direction after a scattering event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00215">mqi_track.hpp:215</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_a6f82cc668e61e6a8fc148cd8405e4a56"><div class="ttname"><a href="classmqi_1_1vec3.html#a6f82cc668e61e6a8fc148cd8405e4a56">mqi::vec3::dump</a></div><div class="ttdeci">CUDA_HOST_DEVICE void dump() const</div><div class="ttdoc">Dumps the vector&#39;s components to the console.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00361">mqi_vec.hpp:361</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_a71cd6aab5b41c688d5556ad8d71ef5bb"><div class="ttname"><a href="classmqi_1_1vec3.html#a71cd6aab5b41c688d5556ad8d71ef5bb">mqi::vec3::y</a></div><div class="ttdeci">T y</div><div class="ttdoc">The y-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00182">mqi_vec.hpp:182</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_a88e9972678dec2310a6ca61b5a8c213c"><div class="ttname"><a href="classmqi_1_1vec3.html#a88e9972678dec2310a6ca61b5a8c213c">mqi::vec3::norm</a></div><div class="ttdeci">CUDA_HOST_DEVICE T norm() const</div><div class="ttdoc">Calculates the Euclidean norm (magnitude) of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00246">mqi_vec.hpp:246</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_ab85f3d384f14b933395fc26780853e69"><div class="ttname"><a href="classmqi_1_1vec3.html#ab85f3d384f14b933395fc26780853e69">mqi::vec3::z</a></div><div class="ttdeci">T z</div><div class="ttdoc">The z-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00183">mqi_vec.hpp:183</a></div></div>
<div class="ttc" id="aclassmqi_1_1vec3_html_ae25341833906691b642cb13a10d43958"><div class="ttname"><a href="classmqi_1_1vec3.html#ae25341833906691b642cb13a10d43958">mqi::vec3::x</a></div><div class="ttdeci">T x</div><div class="ttdoc">The x-component of the vector.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vec_8hpp_source.html#l00181">mqi_vec.hpp:181</a></div></div>
<div class="ttc" id="amqi__common_8hpp_html_a43d03f136f9146a99ee64b9fa56f64ce"><div class="ttname"><a href="mqi__common_8hpp.html#a43d03f136f9146a99ee64b9fa56f64ce">CUDA_CONSTANT</a></div><div class="ttdeci">#define CUDA_CONSTANT</div><div class="ttdef"><b>Definition</b> <a href="mqi__common_8hpp_source.html#l00060">mqi_common.hpp:60</a></div></div>
<div class="ttc" id="amqi__common_8hpp_html_ae1a4fe884f889ba6d532db4c1d191eb7"><div class="ttname"><a href="mqi__common_8hpp.html#ae1a4fe884f889ba6d532db4c1d191eb7">CUDA_HOST_DEVICE</a></div><div class="ttdeci">#define CUDA_HOST_DEVICE</div><div class="ttdef"><b>Definition</b> <a href="mqi__common_8hpp_source.html#l00054">mqi_common.hpp:54</a></div></div>
<div class="ttc" id="amqi__interaction_8hpp_html"><div class="ttname"><a href="mqi__interaction_8hpp.html">mqi_interaction.hpp</a></div><div class="ttdoc">Defines the abstract base class for all physics interaction models.</div></div>
<div class="ttc" id="anamespacemqi_html"><div class="ttname"><a href="namespacemqi.html">mqi</a></div><div class="ttdef"><b>Definition</b> <a href="mqi__const__1d_8hpp_source.html#l00026">mqi_const_1d.hpp:26</a></div></div>
<div class="ttc" id="anamespacemqi_html_a3056e4aa71c04575840237dbfe35b397"><div class="ttname"><a href="namespacemqi.html#a3056e4aa71c04575840237dbfe35b397">mqi::intpl1d</a></div><div class="ttdeci">CUDA_DEVICE T intpl1d(T x, T x0, T x1, T y0, T y1)</div><div class="ttdoc">Performs 1D linear interpolation.</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00043">mqi_math.hpp:43</a></div></div>
<div class="ttc" id="anamespacemqi_html_a3da16fe5ac4fb84d05d6d1620464667e"><div class="ttname"><a href="namespacemqi.html#a3da16fe5ac4fb84d05d6d1620464667e">mqi::mqi_pow</a></div><div class="ttdeci">CUDA_DEVICE T mqi_pow(T s, T p)</div><div class="ttdoc">Calculates a number raised to a power. Wrapper for pow or powf.</div></div>
<div class="ttc" id="anamespacemqi_html_a3fd672c3dd5233871d908ca2b7faf8e0a55eb0fa19cfb266e3482dc7325612c65"><div class="ttname"><a href="namespacemqi.html#a3fd672c3dd5233871d908ca2b7faf8e0a55eb0fa19cfb266e3482dc7325612c65">mqi::PP_E</a></div><div class="ttdeci">@ PP_E</div><div class="ttdoc">Step was limited by a proton-proton elastic scattering event.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00035">mqi_track.hpp:35</a></div></div>
<div class="ttc" id="anamespacemqi_html_a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e"><div class="ttname"><a href="namespacemqi.html#a5673e171c0abcbf25898b8a1fa1ef60ca853cc57f79c283e174716991b3688b4e">mqi::CREATED</a></div><div class="ttdeci">@ CREATED</div><div class="ttdoc">The track has been created but not yet transported.</div><div class="ttdef"><b>Definition</b> <a href="mqi__track_8hpp_source.html#l00047">mqi_track.hpp:47</a></div></div>
<div class="ttc" id="anamespacemqi_html_a594f905ab0e6de5762696db510ef49f1"><div class="ttname"><a href="namespacemqi.html#a594f905ab0e6de5762696db510ef49f1">mqi::cs_pp_e_g4_table</a></div><div class="ttdeci">CUDA_CONSTANT const float cs_pp_e_g4_table[600]</div><div class="ttdef"><b>Definition</b> <a href="#l00011">mqi_pp_elastic.hpp:11</a></div></div>
<div class="ttc" id="anamespacemqi_html_a5e50016c30bdbbfe3f1085ab19f87ad0"><div class="ttname"><a href="namespacemqi.html#a5e50016c30bdbbfe3f1085ab19f87ad0">mqi::mqi_rng</a></div><div class="ttdeci">std::default_random_engine mqi_rng</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00608">mqi_math.hpp:608</a></div></div>
<div class="ttc" id="anamespacemqi_html_a91a6ed407b1f63e7150657ef1aef1194"><div class="ttname"><a href="namespacemqi.html#a91a6ed407b1f63e7150657ef1aef1194">mqi::mqi_acos</a></div><div class="ttdeci">CUDA_DEVICE T mqi_acos(T s)</div><div class="ttdoc">Calculates the arc cosine. Wrapper for acos or acosf.</div></div>
<div class="ttc" id="anamespacemqi_html_add466ef65529d5cbcb7b8a1ee9b32778"><div class="ttname"><a href="namespacemqi.html#add466ef65529d5cbcb7b8a1ee9b32778">mqi::mqi_uniform</a></div><div class="ttdeci">CUDA_DEVICE rnd_return&lt; T &gt;::type mqi_uniform(S *rng)</div><div class="ttdoc">Generates a uniformly distributed random number in [0, 1).</div><div class="ttdef"><b>Definition</b> <a href="mqi__math_8hpp_source.html#l00245">mqi_math.hpp:245</a></div></div>
<div class="ttc" id="anamespacemqi_html_aef88923de451fcfef0ae37638919075f"><div class="ttname"><a href="namespacemqi.html#aef88923de451fcfef0ae37638919075f">mqi::mqi_sqrt</a></div><div class="ttdeci">CUDA_HOST_DEVICE T mqi_sqrt(T s)</div><div class="ttdoc">Calculates the square root. Wrapper for sqrt (double) or sqrtf (float).</div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_a460bf0e1c8220ffd3d43b6f9f0eb77b2"><div class="ttname"><a href="structmqi_1_1vertex__t.html#a460bf0e1c8220ffd3d43b6f9f0eb77b2">mqi::vertex_t::dir</a></div><div class="ttdeci">vec3&lt; T &gt; dir</div><div class="ttdoc">Direction (as a unit vector) of the particle&#39;s momentum.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00022">mqi_vertex.hpp:22</a></div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_a7c579c9150537b19bc1f5fe52893df6c"><div class="ttname"><a href="structmqi_1_1vertex__t.html#a7c579c9150537b19bc1f5fe52893df6c">mqi::vertex_t::ke</a></div><div class="ttdeci">T ke</div><div class="ttdoc">Kinetic energy of the particle at the vertex.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00020">mqi_vertex.hpp:20</a></div></div>
<div class="ttc" id="astructmqi_1_1vertex__t_html_aad1c03cda0a634e9ec666547cb4e0f60"><div class="ttname"><a href="structmqi_1_1vertex__t.html#aad1c03cda0a634e9ec666547cb4e0f60">mqi::vertex_t::pos</a></div><div class="ttdeci">vec3&lt; T &gt; pos</div><div class="ttdoc">Position of the particle in 3D space.</div><div class="ttdef"><b>Definition</b> <a href="mqi__vertex_8hpp_source.html#l00021">mqi_vertex.hpp:21</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_e914ee4d4a44400f1fdb170cb4ead18a.html">base</a></li><li class="navelem"><a href="mqi__pp__elastic_8hpp.html">mqi_pp_elastic.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
